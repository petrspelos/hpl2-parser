void OnEnter()
{
	if(ScriptDebugOn())
	{
		SetGlobalVarInt("FastSeekerAchievement", 1);
		SetGlobalVarInt("HealthAchievement", 1);
		SetGlobalVarInt("ItemsAchievement", 1);
		SetGlobalVarInt("NoDeathAchievement", 1);
		//SetGlobalVarInt("StatuesAchievement", 1);
		SetGlobalVarInt("WardrobeAchievement", 1);
		SetGlobalVarInt("EnemiesAchievement", 1);
		SetGlobalVarInt("PuzzleAchievement", 1);
		//SetGlobalVarInt("NoPuzzleAchievement", 1);
		SetGlobalVarInt("NoStatuesAchievement", 1);
		SetGlobalVarInt("SanityAchievement", 1);
		SetGlobalVarInt("SlimesAchievement", 1);
		SetGlobalVarInt("LightsAchievement", 1);
	}
	
	PreloadParticleSystem("ps_acid_web_dissolve.ps");
	PreloadParticleSystem("ps_dust_falling.ps");
	PreloadParticleSystem("ps_light_dust.ps");
	PreloadParticleSystem("ps_light_dust_large.ps");
	PreloadParticleSystem("ps_area_fog.ps");
	PreloadParticleSystem("ps_area_fog_large.ps");
	PreloadParticleSystem("ps_area_fog_small.ps");
	PreloadParticleSystem("ps_area_fog_sewer_long_warmup.ps");
	PreloadParticleSystem("ps_door_damage_wood.ps");
	PreloadParticleSystem("ps_break_wood.ps");
	
	PreloadParticleSystem("ps_hit_wood.ps");
	PreloadParticleSystem("ps_dust_piano.ps");
	PreloadParticleSystem("ps_iron_maiden_event_smoke.ps");
	
	PreloadSound("insanity_baby_cry.snt");
	PreloadSound("general_wind_whirl_rand.snt");
	PreloadSound("02_clock_huge.snt");
	PreloadSound("02_clock_desk.snt");
	PreloadSound("02_clock_grandfather.snt");
	PreloadSound("02_ambience_house.snt");
	PreloadSound("02_acid_web.snt");
	PreloadSound("02_attack_knife.snt");
	PreloadSound("02_woosh.snt");
	PreloadSound("ambience_wind_eerie.snt");
	PreloadSound("puzzle_acid_success.snt");
	PreloadSound("scare_thump_flash.snt");
	PreloadSound("15_acid.snt");
	PreloadSound("15_fire.snt");
	PreloadSound("15_player_burn.snt");
	PreloadSound("quest_completed.snt");
	PreloadSound("piano_tile_blue.snt");
	PreloadSound("piano_tile_red.snt");
	PreloadSound("piano_tile_yellow.snt");
	PreloadSound("piano_tile_orange.snt");
	PreloadSound("piano_tile_green.snt");
	PreloadSound("piano_tile_purple.snt");
	PreloadSound("piano_tile_full.snt");
	PreloadSound("level_wood_min_max01.snt");
	PreloadSound("24_iron_maiden.snt");
	PreloadSound("00_laugh.snt");
	PreloadSound("lurker_hit_wood.snt");
	PreloadSound("enemy/grunt/notice.snt");
	PreloadSound("03_waking_up.snt");
	PreloadSound("general_piano01.snt");
	PreloadSound("general_piano02.snt");
	PreloadSound("general_piano03.snt");
	PreloadSound("oil_tank_empty.snt");
	PreloadSound("door_level_wood_open.snt");
	
	PreloadSound("gameplay_acid_web.snt");
	PreloadSound("lock_door.snt");
	PreloadSound("locked_door.snt");
	PreloadSound("open_door.snt");
	PreloadSound("open_door_long.snt");
	PreloadSound("door_gate_bar_locked.snt");
	PreloadSound("door_mansion_close.snt");
	PreloadSound("door_mansion_open.snt");
	PreloadSound("close_door.snt");
	PreloadSound("close_door_long.snt");
	PreloadSound("unlock_door.snt");
	PreloadSound("react_breath.snt");
	PreloadSound("react_breath_slow.snt");
	PreloadSound("react_pant.snt");
	PreloadSound("react_scare.snt");
	PreloadSound("react_sigh.snt");
	PreloadSound("general_fire_burning.snt");
	PreloadSound("general_fire_burning_low.snt");
	PreloadSound("break_pottery.snt");
	PreloadSound("break_glass_bottle.snt");
	PreloadSound("break_glass_large.snt");
	PreloadSound("break_wood.snt");
	PreloadSound("break_wood_metal.snt");
	PreloadSound("guardian_activated.snt");
	PreloadSound("guardian_ontop.snt");
	PreloadSound("hit_wood.snt");
	PreloadSound("player_climb.snt");
	PreloadSound("player_crouch.snt");
	PreloadSound("player_jump.snt");
	PreloadSound("player_stand.snt");
	PreloadSound("roll_wood.snt");
	PreloadSound("slime_attack_normal_hit.snt");
	PreloadSound("slime_create.snt");
	PreloadSound("slime_loop.snt");
	PreloadSound("step_run_dirt.snt");
	PreloadSound("step_walk_dirt.snt");
	PreloadSound("step_sneak_dirt.snt");
	PreloadSound("step_run_fabric.snt");
	PreloadSound("step_walk_fabric.snt");
	PreloadSound("step_sneak_fabric.snt");
	PreloadSound("step_run_metal.snt");
	PreloadSound("step_walk_metal.snt");
	PreloadSound("step_sneak_metal.snt");
	PreloadSound("step_run_organic.snt");
	PreloadSound("step_walk_organic.snt");
	PreloadSound("step_sneak_organic.snt");
	PreloadSound("step_run_rock.snt");
	PreloadSound("step_walk_rock.snt");
	PreloadSound("step_sneak_rock.snt");
	PreloadSound("step_run_wood.snt");
	PreloadSound("step_run_wood_squeaky.snt");
	PreloadSound("step_walk_wood.snt");
	PreloadSound("step_walk_wood_squeaky.snt");
	PreloadSound("step_sneak_wood.snt");
	PreloadSound("step_sneak_wood_squeaky.snt");
	PreloadSound("flashback_flash.snt");
	PreloadSound("hurt_pant.snt");
	PreloadSound("sanity_damage.snt");
	PreloadSound("sanity_drain_high.snt");
	PreloadSound("sanity_drain_med.snt");
	PreloadSound("sanity_drain_low.snt");
	PreloadSound("sanity_heartbeat.snt");
	PreloadSound("sanity_pant.snt");
	PreloadSound("ui_add_quest.snt");
	PreloadSound("ui_lantern_off.snt");
	PreloadSound("ui_lantern_on.snt");
	PreloadSound("ui_sanity_gain.snt");
	PreloadSound("ui_terror_meter.snt");
	PreloadSound("enemy_hallucination_disappear.snt");

	SetMapDisplayNameEntry("HouseNice");
	
	SetLanternLitCallback("LanternOilReduced");
	
	SetEntityInteractionDisabled("emotion_stone_1", true);
	
	CheckCurrentVision();
	
	PlayMusic("02_house_piano_theme", true, 0.55f, 1.0f, 0, false);
	
	SetEntityInteractionDisabled("grunt_body_part2_1", true);
	
	SetEntityActive("barrel01_17", false);
	SetEntityActive("book01_12", false);
	SetEntityActive("book01_13", false);
	
	if(GetGlobalVarInt("HealthAchievement") == 1)
		AddTimer("checkhealth", 10.0f, "TimerHealthAchievement");
	if(GetGlobalVarInt("FastSeekerAchievement") == 1)
		SetPlayerRunSpeedMul(1.175f);
	if(GetGlobalVarInt("WardrobeAchievement") == 1)
		SetPlayerJumpForceMul(1.175f);
}

void OnLeave()
{
	RemoveTimer("addhealth");
	RemoveTimer("checkhealth");
	if(GetGlobalVarInt("ItemsAchievement") == 1)
		if(GetPlayerLampOil() <= 20.0f)
			AddPlayerLampOil(20.0f);
}

void OnStart()
{
	AddEntityCollideCallback("Player", "AreaFailMotherQuest", "CollideAreaFailMotherQuest", true, 1);
	AddEntityCollideCallback("violin_1", "AreaFailFatherQuest", "CollideAreaFailFatherQuest", false, 0);
	AddEntityCollideCallback("Player", "AreaFire", "CollideAreaFire", false, 0);
	AddEntityCollideCallback("Player", "AreaEscapeBrute_1", "CollideAreaEscapeBrute", true, 1);
	AddEntityCollideCallback("Player", "AreaEscapeBrute_2", "CollideAreaEscapeBrute", true, 1);
	AddEntityCollideCallback("Player", "AreaEscapeBrute_3", "CollideAreaEscapeBrute", true, 1);
	AddEntityCollideCallback("Player", "AreaEscapeGrunt_1", "CollideAreaEscapeGrunt", true, 1);
	AddEntityCollideCallback("shirt_folded_white_grab_2", "AreaFatherWardrobe", "CollideAreaFatherWardrobe", true, 1);
	AddEntityCollideCallback("shirt_folded_white_grab_3", "AreaFatherWardrobe", "CollideAreaFatherWardrobe", true, 1);
	AddEntityCollideCallback("Player", "RottenApplesArea_1", "ActivateRottenApples1", true, 1);
	AddEntityCollideCallback("Player", "RottenApplesArea_2", "ActivateRottenApples2", true, 1);
	AddEntityCollideCallback("Player", "AreaActiveGrunt_1", "CollideAreaActiveGrunt", true, 1);
	AddEntityCollideCallback("Player", "AreaActiveGrunt_2", "CollideAreaActiveGrunt", true, 1);
	AddEntityCollideCallback("Player", "AreaActiveGrunt_3", "CollideAreaActiveGrunt", true, 1);
	AddEntityCollideCallback("Player", "AreaActiveGrunt_4", "CollideAreaActiveGrunt", true, 1);
	AddEntityCollideCallback("Player", "AreaDiscoverLoveRoom", "CollideAreaDiscoverLoveRoom", true, 1);
	AddEntityCollideCallback("Player", "AreaDiscoverStorageDoor", "CollideAreaDiscoverStorageDoor", true, 1);
	AddEntityCollideCallback("Player", "AreaDiscoverWineBarrel", "CollideAreaDiscoverWineBarrel", true, 1);
	AddEntityCollideCallback("Player", "AreaDiscoverPiano", "CollideAreaDiscoverPiano", true, 1);
	AddEntityCollideCallback("Player", "AreaDiscoverGrunt", "CollideAreaDiscoverGrunt", true, 1);
	AddEntityCollideCallback("Player", "AreaActiveBrute_1", "CollideAreaActiveBrute", true, 1);
	AddEntityCollideCallback("Player", "AreaActiveBrute_2", "CollideAreaActiveBrute", true, 1);
	AddEntityCollideCallback("Player", "AreaActiveAngel_1", "CollideAreaActiveAngel", true, 1);
	AddEntityCollideCallback("Player", "AreaActiveAngel_2", "CollideAreaActiveAngel", true, 1);
	AddEntityCollideCallback("Player", "AreaActiveSuitor_1", "CollideAreaActiveSuitor", true, 1);
	AddEntityCollideCallback("Player", "AreaWineBarrel", "CollideAreaWineBarrel", true, 1);
	AddEntityCollideCallback("Player", "AreaRollBarrel", "CollideAreaRollBarrel", true, 1);
	AddEntityCollideCallback("Player", "AreaBookJump", "CollideAreaBookJump", true, 1);
	AddEntityCollideCallback("Player", "AreaFallPlate", "CollideAreaFallPlate", true, 1);
	
	AddUseItemCallback("NeedleDoor", "hollow_needle_1", "castle_1", "UsedKeyOnDoor", true);
	AddUseItemCallback("ContainerAcid", "glass_container_1", "acid_container_1", "UsedContainerOnAcid", true);
	AddUseItemCallback("KeyFrontDoor", "key_tower_1", "level_wood_double_1", "UsedKeyOnDoor", true);

	SetMapDisplayNameEntry("HouseNice");
	
	SetEntityPlayerInteractCallback("arabic_statue_1", "TouchLittleStatue", true);
	SetEntityPlayerInteractCallback("arabic_statue_gold_1", "TouchLittleStatue", true);
	SetEntityPlayerInteractCallback("arabic_statue_2", "TouchLittleStatue", true);
	SetEntityPlayerInteractCallback("arabic_statue_gold_2", "TouchLittleStatue", true);
	SetEntityPlayerInteractCallback("shirt_folded_white_grab_1", "TouchShirt", true);
	SetEntityPlayerInteractCallback("mansion_5", "TouchMansionDoor", true);
	SetEntityPlayerInteractCallback("ceremony_knife_1", "PickedUpKnife", true);
	SetEntityPlayerInteractCallback("glass_container_1", "PickedUpContainer", true);
	SetEntityPlayerInteractCallback("orbpiece_turquoise_1", "PickedUpOrbPiece", true);
	SetEntityPlayerInteractCallback("FadeContainerArea_1", "FadeContainer", true);
	SetEntityPlayerInteractCallback("FadeContainerArea_2", "FadeContainer", true);
	SetEntityPlayerInteractCallback("note_scroll_1", "PickedUpNote", true);
	SetEntityPlayerInteractCallback("note_generic_1", "PickedUpNote", true);
	SetEntityPlayerInteractCallback("note_letter_1", "PickedUpNote", true);
	SetEntityPlayerInteractCallback("AreaTileRed", "TouchPianoTile", false);
	SetEntityPlayerInteractCallback("AreaTileGreen", "TouchPianoTile", false);
	SetEntityPlayerInteractCallback("AreaTilePurple", "TouchPianoTile", false);
	SetEntityPlayerInteractCallback("AreaTileYellow", "TouchPianoTile", false);
	SetEntityPlayerInteractCallback("AreaTileBlue", "TouchPianoTile", false);
	SetEntityPlayerInteractCallback("AreaTileOrange", "TouchPianoTile", false);
	
	SetEntityInteractionDisabled("grunt_body_part2_1", true);
	
	SetEntityCustomFocusCrossHair("FadeContainerArea_1", "Pick");
	SetEntityCustomFocusCrossHair("FadeContainerArea_2", "Pick");
	
	for(int i=1; i<=15; i++)
	{
		AddUseItemCallback("knifeonslime_" + i, "ceremony_knife_1", "slime_anim_ceiling_" + i, "UsedKnifeOnSlime", false);
		AddUseItemCallback("knifeonslime_" + i, "ceremony_knife_1", "slime_anim_wall_" + i, "UsedKnifeOnSlime", false);
	}
	for(int w=1; w<=5; w++)
		AddEntityCollideCallback("Player", "AreaWardrobe_" + w, "CollideAreaWardrobe", true, 1);
	
	for(int h=1; h<=8; h++)
		AddEntityCollideCallback("Player", "AreaAngelKill_" + h, "CollideAreaAngelKill", true, 1);
	
	if(ScriptDebugOn())
	{
		if(HasItem("lantern_1") == false) GiveItemFromFile("lantern_1", "lantern.ent");
	}
}

void LanternOilReduced(bool abLit)
{
	if(abLit == true)
	{
		AddTimer("checkoil", 5.0f, "TimerCheckOil");
	}
	else
	{
		RemoveTimer("checkoil");
	}
}

void TimerCheckOil(string &in asTimer)
{
	if(asTimer == "checkoil")
	{
		if(GetPlayerLampOil() > 2.0f)
		{
			AddPlayerLampOil(-0.726f);
			AddTimer("checkoil", 5.0f, "TimerCheckOil");
		}
	}
}

void TimerHealthAchievement(string &in asTimer)
{
	if(asTimer == "addhealth")
	{
		if(GetPlayerHealth() <= 98.0f)
		{
			AddPlayerHealth(2.0f);
			AddTimer("addhealth", 7.0f, "TimerHealthAchievement");
		}
		else
		{
			AddTimer("checkhealth", 10.0f, "TimerHealthAchievement");
		}
	}
	else if(asTimer == "checkhealth")
	{
		if(GetPlayerHealth() > 98.0f)
		{
			AddTimer("checkhealth", 10.0f, "TimerHealthAchievement");
		}
		else
		{
			AddTimer("addhealth", 7.0f, "TimerHealthAchievement");
		}
	}
	else if(asTimer == "pausehealth")
	{
		RemoveTimer("addhealth");
		RemoveTimer("checkhealth");
	}
}

void CollideAreaAngelKill(string &in asParent, string &in asChild, int alState)
{
	PlaySoundAtEntity("ironmaidensound", "24_iron_maiden", asChild, 0.0f, false);
	PlaySoundAtEntity("laughsound", "00_laugh", asChild, 0.0f, false);
	StartScreenShake(0.3f, 0.3f, 0.0f, 0.3f);
	GivePlayerDamage(1000000.0f, "BloodSplat", true, true);
	PlayGuiSound("slime_attack_normal_hit.snt", 1.0f);
}
void CollideAreaWardrobe(string &in asParent, string &in asChild, int alState)
{
	AddLocalVarInt("WardrobeCount", 1);
	if(GetLocalVarInt("WardrobeCount") == 5)
		AddTimer("WardrobeAchievement", 1.0f, "TimerUnlockAchievement");
}

void TimerUnlockAchievement(string &in asTimer)
{
	AddQuest(asTimer, asTimer);
	PlayMusic("00_achievement_unlocked", false, 0.7f, 0.5f, 10, false);
	SetGlobalVarInt(asTimer, 1);
	SetMessage("Hints", asTimer, 10.0f);
	if(asTimer == "WardrobeAchievement")
	{
		SetPlayerJumpForceMul(1.175f);
	}
}

void TouchPianoTile(string &in asEntity)
{
	AddLocalVarInt("PianoTilesTouchedCount", 1);
	if(asEntity == "AreaTileRed") PlaySoundAtEntity("redtilesound", "piano_tile_red.snt", asEntity, 0.0f, false);
	if(asEntity == "AreaTileGreen") PlaySoundAtEntity("greentilesound", "piano_tile_green.snt", asEntity, 0.0f, false);
	if(asEntity == "AreaTilePurple") PlaySoundAtEntity("purpletilesound", "piano_tile_purple.snt", asEntity, 0.0f, false);
	if(asEntity == "AreaTileYellow") PlaySoundAtEntity("yellowtilesound", "piano_tile_yellow.snt", asEntity, 0.0f, false);
	if(asEntity == "AreaTileBlue") PlaySoundAtEntity("bluetilesound", "piano_tile_blue.snt", asEntity, 0.0f, false);
	if(asEntity == "AreaTileOrange") PlaySoundAtEntity("orangetilesound", "piano_tile_orange.snt", asEntity, 0.0f, false);
	if(GetLocalVarInt("PianoTilesTouchedCount") == 3) SetMessage("Woman", "05", 4.0f);
	if(GetLocalVarInt("PianoTilesTouchedCount") == 6) SetMessage("Woman", "06", 4.0f);
	if(GetLocalVarInt("PianoTilesTouchedCount") == 9)
	{
		AddTimer("resetspeedmul", 6.0f, "TimerStopLook");
		AddTimer("jack34", 7.0f, "TimerSaySomething");
		SetEntityActive("AreaTileRed", false);
		SetEntityActive("AreaTileGreen", false);
		SetEntityActive("AreaTilePurple", false);
		SetEntityActive("AreaTileYellow", false);
		SetEntityActive("AreaTileBlue", false);
		SetEntityActive("AreaTileOrange", false);
		SetEntityActive("AreaActiveSuitor_1", true);
		SetMessage("Woman", "07", 7.0f);
		
		SetLampLit("candle_floor_small_1", false, true);
		
		SetPlayerMoveSpeedMul(0.2f);
		SetPlayerRunSpeedMul(0.2f);
		SetPlayerLookSpeedMul(0.2f);
		
		SetLeverStuckState("piano_1", 0, false);
		AddPropImpulse("piano_1", 0,0,-20, "world");
	
		GiveSanityDamage(5.0f, true);
	
		CreateParticleSystemAtEntity("PSdust", "ps_dust_piano.ps", "AreaPianoDust", false);
	
		AddTimer("liddust", 0.4f, "FallBook");
		
		PlayMusic("02_piano_eerie_stinger04", false, 1.0f, 2.0f, 10, false);
		SetPropActiveAndFade("angel_statue_1", false, 2.0f);
		SetSwingDoorLocked("mansion_9", false, false);
	}
}

void TimerReplaceEntity(string &in asTimer)
{
	if(asTimer == "painting01") SetEntityActive("painting01_3_dyn", true);
}

void FallBook(string &in asTimer)
{
	if(asTimer == "liddust")
	{
		PlaySoundAtEntity("LidClose", "level_wood_min_max01.snt", "piano_1", 0.0f, false);
	}
}

void PickedUpNote(string &in asItem)
{
	if(asItem == "note_scroll_1")
	{
		GiveSanityBoost();
		CompleteQuest("LabMission", "LabMission");
		CompleteQuest("MusicSheetMission", "MusicSheetMission");
		FadeLightTo("PointLight_18", 0.0f ,0.0f ,0.0f ,0.0f , -1, 2);
		SetGlobalVarInt("LabQuestFailed", 0);
		FadeEnemyToSmoke("suitor_1", false);
		FadeEnemyToSmoke("suitor_2", true);
		FadeEnemyToSmoke("brute_1", false);
		FadeEnemyToSmoke("grunt_2", false);
		RemoveItem("key_tower_1");
		
		AddTimer("prelab", 0.001f, "TimerLoadWood");
	}
	if(asItem == "note_generic_1")
	{
		AddGlobalVarInt("StrangeNoteCount", 1);
		if(GetGlobalVarInt("StrangeNoteCount") == 1) AddQuest("StrangeNotesMission", "StrangeNotesMission");
		StopSound("note_generic_1_sound", 0.1f);
	}
	if(asItem == "note_letter_1")
	{
		AddTimer("painting01", 1.0f, "TimerReplaceEntity");
		SetEntityActive("painting01_3", false);
		StopPlayerLookAt();
		SetEntityActive("AreaActiveAngel_2", true);
		SetEntityActive("angel_36", false);
		AddEntityCollideCallback("Player", "AreaActiveSuitor_1", "CollideAreaActiveSuitor", false, 0);
	}
}

void UsedContainerOnAcid(string &in asItem, string &in asEntity)
{
	GiveSanityBoostSmall();
	AddTimer("woman02", 1.0f, "TimerSaySomething");
	AddTimer("activeplayer", 5.0f, "TimerStopLook");
	GiveItem("glass_container_mix_done_1", "glass_container_mix_done", "ChemicalContainerFull", "chemical_container_full.tga" , 1.0f);
	PlayGuiSound("puzzle_acid_success", 0.7f);
	SetSwingDoorLocked("mansion_3", false, false);
	SetPlayerActive(false);
	StartPlayerLookAt("mansion_3", 0.7f, 0.7f, "");
	RemoveItem(asItem);
}

void FadeContainer(string &in asEntity)
{
	PlayGuiSound("scare_thump_flash", 1.0f);
	PlayGuiSound("sanity_drain_high", 0.7f);
	StartScreenShake(0.2f, 0.1f, 0.0f, 0.0f);
	if(asEntity == "FadeContainerArea_1")
	{
		SetPropActiveAndFade("fakecontainer_1", false, 1.0f);
		SetEntityActive("fakecontainer_2", true);
		SetEntityActive("FadeContainerArea_2", true);
		SetEntityCustomFocusCrossHair("FadeContainerArea_2", "Pick");
		SetMessage("Jack", "14", 5.0f);
	}
	if(asEntity == "FadeContainerArea_2")
	{
		SetPropActiveAndFade("fakecontainer_2", false, 1.0f);
		SetEntityActive("glass_container_1", true);
		SetMessage("Jack", "15", 4.0f);
	}
}

void UsedKnifeOnSlime(string &in asItem, string &in asEntity)
{
	SetPropActiveAndFade(asEntity, false, 2.0f);
	CreateParticleSystemAtEntity("fadeoutslime", "particles/ps_acid_web_dissolve.ps", asEntity, false);
	PlaySoundAtEntity("fadeoutslimesound", "02_acid_web.snt", asEntity, 0.1f, false);
	PlayGuiSound("02_attack_knife.snt", 1.0f);
	if(GetGlobalVarInt("LibraryQuest") == 0)
	{
		AddLocalVarInt("SlimeCutCount", 1);
		if(GetLocalVarInt("SlimeCutCount") == 1)
		{
			SetGlobalVarInt("LibraryQuestFailed", 1);
			SetMessage("Jack", "24", 7.0f);
		}
		if(GetLocalVarInt("SlimeCutCount") == 10)
		{
			GiveSanityBoostSmall();
			SetEntityActive("AreaEscapeBrute_3", true);
			FadeLightTo("PointLight_21", 0.2f, 0.4f, 0.8f, 0.9f, -1, 2.0f);
			SetMessage("Jack", "25", 7.0f);
		}
		if(GetGlobalVarInt("MotherQuestFailed") == 1)
		{
			if(GetLocalVarInt("SlimeCutCount") == 19) SetMessage("Jack", "26", 7.0f);
			if(GetLocalVarInt("SlimeCutCount") == 20)
			{
				GiveSanityBoost();
				FadeEnemyToSmoke("grunt_3", true);
				FadeEnemyToSmoke("brute_2", false);
				FadeEnemyToSmoke("brute_3", false);
				SetEntityActive("AreaActiveBrute_3", false);
				SetEntityActive("AreaActiveGrunt_3", false);
				SetMessage("Jack", "27", 8.0f);
				SetGlobalVarInt("LibraryQuestFailed", 0);
				//StopSound("slime_sound_rand", 3.0f);
				PlayMusic("02_house_piano_theme", false, 0.55f, 1.0f, 10, false);
				CompleteQuest("LibraryMission1", "LibraryMission1");
				AddQuest("LibraryMission2", "LibraryMission2");
			}
		}
		else
		{
			if(GetLocalVarInt("SlimeCutCount") == 17) SetMessage("Jack", "26", 7.0f);
			if(GetLocalVarInt("SlimeCutCount") == 18)
			{
				GiveSanityBoost();
				FadeEnemyToSmoke("grunt_3", true);
				FadeEnemyToSmoke("brute_2", false);
				FadeEnemyToSmoke("brute_3", false);
				SetEntityActive("AreaActiveBrute_3", false);
				SetEntityActive("AreaActiveGrunt_3", false);
				SetMessage("Jack", "27", 8.0f);
				SetGlobalVarInt("LibraryQuestFailed", 0);
				//StopSound("slime_sound_rand", 3.0f);
				PlayMusic("02_house_piano_theme", false, 0.55f, 1.0f, 10, false);
				CompleteQuest("LibraryMission1", "LibraryMission1");
				AddQuest("LibraryMission2", "LibraryMission2");
			}
		}
	}
	for(int k=1; k<=15; k++)
	{
		if(asEntity == "slime_anim_ceiling_" + k) StopSound("slime_anim_ceiling_sound_" + k, 1.0f);
		if(asEntity == "slime_anim_wall_" + k) StopSound("slime_anim_wall_sound_" + k, 1.0f);
	}
}

void PickedUpOrbPiece(string &in asItem)
{
	AddGlobalVarInt("OrbPieceCount", 1);
	if(asItem == "orbpiece_turquoise_1")
	{
		SetLampLit("orb_pedestal_1", false, true);
	}
}

void PickedUpKnife(string &in asItem)
{
	AddQuest("LibraryMission1", "LibraryMission1");
	SetSwingDoorLocked("mansion_1", false, false);
	SetMessage("Jack", "22", 9.0f);
	FadeLightTo("PointLight_12", 0.0f ,0.0f ,0.0f ,0.0f , -1, 2);
	//PlaySoundAtEntity("slime_sound_rand", "02_guardian_idle_rand.snt", "Player", 1.0f, false);
	PlayMusic("02_amb_strange", true, 1.0f, 0.1f, 0, false);
	for(int i=1; i<=15 ; i++)
	{
		PlaySoundAtEntity("slime_anim_ceiling_sound_" + i, "slime_loop", "slime_anim_ceiling_" + i, 2.0f, true);
		PlaySoundAtEntity("slime_anim_wall_sound_" + i, "slime_loop", "slime_anim_wall_" + i, 2.0f, true);
	}
	AddTimer("Sounds", 2.0f, "TimerFixSlimes");
}

void PickedUpContainer(string &in asItem)
{
	CompleteQuest("WineMission1", "WineMission1");
	AddQuest("WineMission2", "WineMission2");
	FadeLightTo("PointLight_13", 0,0,0,0, -1, 2);
	GiveSanityBoostSmall();
	SetEntityActive("AreaWineBarrel", true);
	SetEntityActive("AreaRollBarrel", true);
	
	if(GetGlobalVarInt("StorageQuestFailed") == 1) AddTimer("grunt3", RandFloat(2.5f, 3.5f), "TimerActiveGrunt");
}

void CollideAreaFallPlate(string &in asParent, string &in asChild, int alState)
{
	AddPropImpulse("plate_28", 3, 0, 0, "world");
	AddTimer("scare", 1.0f, "TimerPlayerReactions");
}

void CollideAreaBookJump(string &in asParent, string &in asChild, int alState)
{
	AddTimer("scare", 1.2f, "TimerPlayerReactions");
	SetEntityActive("book01_12", true);
	SetEntityActive("book01_13", true);
}

void CollideAreaRollBarrel(string &in asParent, string &in asChild, int alState)
{
	AddTimer("breath", 1.0f, "TimerPlayerReactions");
	SetEntityActive("barrel01_17", true);
	AddPropImpulse("barrel01_17", 10, -2, 0, "world");
}

void CollideAreaDiscoverLoveRoom(string &in asParent, string &in asChild, int alState)
{
	PlayGuiSound("insanity_baby_cry.snt", 0.7f);
	SetMessage("Jack", "DiscoverLoveRoom", 7.5f);
}

void CollideAreaDiscoverPiano(string &in asParent, string &in asChild, int alState)
{
	AddTimer("", 2.0f, "TimerStopLook");
	SetMessage("Woman", "03", 5.0f);
	StartPlayerLookAt("armour_rusty_complete_4", 1.0f, 1.0f, "");
	AddTimer("randpianoplaysstop", 0.2f, "TimerRandPianoPlays");
}

void CollideAreaActiveAngel(string &in asParent, string &in asChild, int alState)
{
	if(asChild == "AreaActiveAngel_1")
	{
		AddTimer("", 3.0f, "TimerStopLook");
		SetPropActiveAndFade("angel_statue_1", true, 1.5f);
		StartPlayerLookAt("angel_statue_1", 1.5f, 1.5f, "");
		PlayMusic("02_strange", true, 0.55f, 0.0f, 0, false);
		SetMessage("Woman", "04", 6.0f);
	}
	if(asChild == "AreaActiveAngel_2")
	{
		AddTimer("pant", 0.1f, "TimerPlayerReactions");
		AddTimer("breath", 2.1f, "TimerPlayerReactions");
		SetSwingDoorDisableAutoClose("cabinet_metal_1", true);
		SetSwingDoorClosed("cabinet_metal_1", false, false);
		AddBodyImpulse("cabinet_metal_1_leftDoor", 2, 0 , 2, "world");
		AddBodyImpulse("cabinet_metal_1_rightDoor", 2, 0 , 2, "world");
		
		AddTimer("cabinet_metal_1", 0.1f, "TimerExtraDoorImpulse");
	
		PlaySoundAtEntity("ironmaidensound", "24_iron_maiden", "AreaIronMaidenEffect", 0.0f, false);
		PlaySoundAtEntity("angelstatue2sound", "00_laugh", "angel_statue_2", 0.0f, false);
		
		CreateParticleSystemAtEntity("cabinetsmoke","ps_iron_maiden_event_smoke.ps", "AreaIronMaidenEffect", false);
		StartScreenShake(0.1f, 0.1f, 0.0f, 0.1f);
		
		SetPropActiveAndFade("angel_statue_2", false, 5.0f);
	}
}

void TimerExtraDoorImpulse(string &asTimer)
{
	if(asTimer == "cabinet_metal_1")
	{
		AddBodyImpulse("cabinet_metal_1_leftDoor", 2, 0 , 2, "world");
		AddBodyImpulse("cabinet_metal_1_rightDoor", 2, 0 , 2, "world");
	}
}

void ActivateRottenApples1(string &in asParent, string &in asChild, int alState)
{
	AddTimer("scare", 0.6f, "TimerPlayerReactions");
	AddTimer("breath", 4.1f, "TimerPlayerReactions");
	SetEntityActive("rotten_apple_12", true);
	SetEntityActive("rotten_apple_13", true);
	SetEntityActive("rotten_apple_14", true);
	SetEntityActive("rotten_apple_15", true);
	SetEntityActive("rotten_apple_16", true);
	SetEntityActive("rotten_apple_17", true);
	SetEntityActive("rotten_apple_18", true);
	SetEntityActive("rotten_apple_19", true);
	SetEntityActive("rotten_apple_20", true);
	SetEntityActive("rotten_apple_21", true);
	SetEntityActive("rotten_apple_22", true);
	SetEntityActive("rotten_apple_23", true);
	SetEntityActive("rotten_apple_24", true);
	SetEntityActive("rotten_apple_25", true);
	SetEntityActive("rotten_apple_26", true);
}
void ActivateRottenApples2(string &in asParent, string &in asChild, int alState)
{
	AddTimer("scare", 0.6f, "TimerPlayerReactions");
	AddTimer("breath", 4.1f, "TimerPlayerReactions");
	SetEntityActive("rotten_apple_1", true);
	SetEntityActive("rotten_apple_2", true);
	SetEntityActive("rotten_apple_3", true);
	SetEntityActive("rotten_apple_4", true);
	SetEntityActive("rotten_apple_5", true);
	SetEntityActive("rotten_apple_6", true);
	SetEntityActive("rotten_apple_7", true);
	SetEntityActive("rotten_apple_8", true);
	SetEntityActive("rotten_apple_9", true);
	SetEntityActive("rotten_apple_10", true);
	SetEntityActive("rotten_apple_11", true);
}

void CollideAreaFire(string &in asParent, string &in asChild, int alState)
{
	if(alState == 1) AddTimer("burn", 0.1f, "TimerBurnFire");
	else RemoveTimer("burn");
}

void TimerBurnFire(string &in asTimer)
{
	PlayGuiSound("15_player_burn.snt", 1.0f);
	GivePlayerDamage(5.0f, "BloodSplat", false,false);	
	AddTimer("burn", 1.0f, "TimerBurnFire");
}

void CollideAreaEscapeBrute(string &in asParent, string &in asChild, int alState)
{
	if(asChild == "AreaEscapeBrute_1")
	{
		AddTimer("prefather", 0.001f, "TimerLoadWood");
		SetEntityActive("brute_1", false);
		SetEntityActive("block_2", false);
	}
	if(asChild == "AreaEscapeBrute_2")
	{
		CompleteQuest("WineMission1", "WineMission1");
		CompleteQuest("WineMission2", "WineMission2");
		CompleteQuest("WineMission3", "WineMission3");
		AddTimer("prewine", 0.001f, "TimerLoadWood");
		SetEntityActive("brute_1", false);
		SetEntityActive("grunt_3", false);
		SetEntityActive("grunt_4", false);
		SetEntityActive("mansion_1", true);
		GiveSanityBoostSmall();
		StartPlayerLookAt("shelf_high02_1", 2.0f, 2.0f, "");
	}
	if(asChild == "AreaEscapeBrute_3")
	{
		CompleteQuest("LibraryMission1", "LibraryMission1");
		CompleteQuest("LibraryMission2", "LibraryMission2");
		AddTimer("prelibrary", 0.001f, "TimerLoadWood");
		SetEntityActive("brute_2", false);
		SetEntityActive("brute_3", false);
		SetEntityActive("grunt_3", false);
		FadeLightTo("PointLight_21", 0.0f, 0.0f, 0.0f, 0.0f, -1, 2.0f);
		//StopSound("slime_sound_rand", 3.0f);
	}
}

void CollideAreaEscapeGrunt(string &in asParent, string &in asChild, int alState)
{
	if(asChild == "AreaEscapeGrunt_1")
	{
		SetEntityActive("grunt_1", false);
		SetEntityActive("grunt_2", false);
		
		CompleteQuest("OpenStorageDoor", "OpenStorageDoor");
		CompleteQuest("StorageMission", "StorageMission");
		
		AddTimer("prestorage", 0.001f, "TimerLoadWood");
	}
}

void CollideAreaFatherWardrobe(string &in asParent, string &in asChild, int alState)
{
	AddLocalVarInt("FatherShirts", 1);
	SetPropActiveAndFade(asParent, false, 1.0f);
	PlayGuiSound("quest_completed.snt", 0.7f);
	if(GetLocalVarInt("FatherShirts") >= 2)
	{
		CompleteQuest("FatherMission", "FatherMission");
		GiveSanityBoostSmall();
		SetPlayerActive(false);
		AddTimer("prefather", 8.0f, "TimerLoadWood");
		SetMessage("Father", "05", 8.0f);
		PlayMusic("02_puzzle", false, 1.0f, 0.0f, 10, true);
		
		if(GetGlobalVarInt("FastQuestCount") == 1)
		{
			RemoveTimer("FatherQuestTimer");
			AddGlobalVarInt("FastQuestCount", 1);
		}
	}
}

void CollideAreaFailFatherQuest(string &in asParent, string &in asChild, int alState)
{
	if(alState == -1)
	{
		SetEntityActive("AreaFailFatherQuest", false);
		AddTimer("brute1", 6.0f, "TimerActiveBrute");
		CheckPoint ("frombrute1", "PlayerStartArea_2", "CPBrute1", "DeathHints", "StealthyAndEscape");
		PlayMusic("02_piano_eerie_stinger02", false, 0.7f, 0.0f, 10, true);
		SetMessage("Father", "03", 6.0f);
		SetGlobalVarInt("FatherQuestFailed", 1);
		SetEntityActive("AreaEscapeBrute_1", true);
		SetEntityActive("block_2", true);
		SetSwingDoorClosed("mansion_4", true, true);
		SetSwingDoorLocked("mansion_4", true, true);
		SetEntityPlayerInteractCallback("shirt_folded_white_grab_1", "", true);
		SetEntityActive("AreaFatherWardrobe", false);
		CompleteQuest("FatherMission", "FatherMission");
		
		SetGlobalVarInt("FastQuestCount", 0);
	}
	else if(alState == 1)
	{

	}
}

void TimerActiveGrunt(string &in asTimer)
{
	if(asTimer == "grunt3")
	{
		ClearEnemyPatrolNodes("grunt_3");
	
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_47", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_48", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_49", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_50", RandFloat(3.5f, 6.5f), ""); 
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_84", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_83", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_82", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_81", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_80", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_79", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_78", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_77", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_76", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_92", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_93", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_94", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_95", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_96", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_97", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_98", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_99", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_98", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_97", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_96", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_95", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_104", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_105", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_106", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_115", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_116", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_117", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_124", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_125", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_126", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_127", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_131", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_132", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_134", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_135", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_136", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_135", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_134", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_318", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_317", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_316", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_315", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_300", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_299", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_298", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_297", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_296", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_295", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_300", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_315", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_318", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_134", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_135", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_136", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_137", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_138", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_139", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_138", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_137", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_136", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_135", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_134", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_132", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_131", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_127", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_126", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_125", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_124", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_117", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_116", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_115", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_106", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_95", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_93", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_92", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_76", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_85", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_49", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_48", 0.001f, "");
		
		SetEntityActive("grunt_3", true);
	}
}

void TimerActiveBrute(string &in asTimer)
{
	if(asTimer == "brute1")
	{
		ClearEnemyPatrolNodes("brute_1");
		
		AddEnemyPatrolNode("brute_1", "PathNodeArea_1", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_2", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_3", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_4", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_5", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_6", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_7", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_8", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_9", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_10", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_11", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_12", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_13", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_14", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_15", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_16", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_3", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_2", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_1", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_17", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_18", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_19", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_20", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_21", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_22", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_23", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_24", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_25", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_26", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_25", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_27", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_23", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_22", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_21", RandFloat(3.5f, 6.5f), "");
		
		SetEntityActive("brute_1", true);
		
		PlayMusic("19_event_brute", false, 0.7f, 0.0f, 10, true);
		AddTimer("panteffect", 0.6f, "TimerPlayerReactions");
		AddTimer("breatheffect", 2.0f, "TimerPlayerReactions");
		
		SetMessage("Jack", "23", 5.0f);
	}
	if(asTimer == "brute2")
	{
		ClearEnemyPatrolNodes("brute_2");
		
		AddEnemyPatrolNode("brute_2", "PathNodeArea_360", 0.001f, "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_361", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_364", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_365", 0.001f, "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_371", 0.001f, "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_373", 0.001f, "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_374", 0.001f, "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_284", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_292", 0.001f, "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_294", 0.001f, "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_289", 0.001f, "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_281", 0.001f, "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_195", 0.001f, "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_179", 0.001f, "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_319", 0.001f, "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_156", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_157", 0.001f, "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_330", 0.001f, "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_331", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_330", 0.001f, "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_157", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_34", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_1", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_33", 0.001f, "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_321", 0.001f, "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_140", 0.001f, "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_141", 0.001f, "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_158", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_320", 0.001f, "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_264", 0.001f, "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_280", 0.001f, "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_286", 0.001f, "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_287", 0.001f, "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_284", 0.001f, "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_374", 0.001f, "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_373", 0.001f, "");
		AddEnemyPatrolNode("brute_2", "PathNodeArea_370", 0.001f, "");
	
		SetEntityActive("brute_2", true);
		SetPropActiveAndFade("arabic_statue_giant_1", false, 2.0f);
		SetPropActiveAndFade("arabic_statue_giant_2", false, 2.0f);
		
		PlayGuiSound("enemy_hallucination_disappear.snt", 1.0f);
		PlayMusic("00_event_hallway", false, 0.7f, 0.0f, 10, true);
		AddTimer("panteffect", 0.6f, "TimerPlayerReactions");
		AddTimer("breatheffect", 2.0f, "TimerPlayerReactions");		
	}
}

void CollideAreaActiveBrute(string &in asParent, string &in asChild, int alState)
{
	if(asChild == "AreaActiveBrute_1")
	{
		ClearEnemyPatrolNodes("brute_1");
		AddTimer("resetspeedmul", 3.0f, "TimerStopLook");
		AddTimer("panteffect", 0.6f, "TimerPlayerReactions");
		AddTimer("breatheffect", 2.0f, "TimerPlayerReactions");
		SetMessage("Jack", "18", 5.0f);
		PlaySoundAtEntity("breakdoorsound", "break_wood.snt", "AreaBreakDoorSound_1", 0.0f, false);
		StartPlayerLookAt("brute_1", 3.0f, 3.0f, "");
		StartScreenShake(0.025, 1, 1, 1); 
		SetPlayerMoveSpeedMul(0.1f);
		SetPlayerRunSpeedMul(0.1f);
		SetPlayerLookSpeedMul(0.1f);
		
		SetEntityActive("brute_1", true);
		
		AddEnemyPatrolNode("brute_1", "PathNodeArea_34", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_140", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_141", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_142", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_144", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_145", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_146", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_147", RandFloat(2.5f, 3.5f), "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_151", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_142", RandFloat(2.5f, 3.5f), "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_155", RandFloat(3.5f, 5.5f), "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_321", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_21", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_23", RandFloat(2.5f, 3.5f), "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_21", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_1", 0.001f, "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_3", RandFloat(2.5f, 3.5f), "");
		AddEnemyPatrolNode("brute_1", "PathNodeArea_1", RandFloat(1.5f, 2.5f), "");
		
		PlayMusic("26_event_brute", false, 0.7f, 0.0f, 10, true);
	}
	if(asChild == "AreaActiveBrute_2")
	{
		AddTimer("activeplayer", 8.0f, "TimerStopLook");
		AddTimer("jack04", 8.0f, "TimerSaySomething");
		AddTimer("brute2", 11.0f, "TimerActiveBrute");
		SetMessage("Statue", "01", 8.0f);
		AddTimer("jackmorenightmares", 11.0f, "TimerSaySomething");
		StartPlayerLookAt("chandelier_nice_7", 3.0f, 3.0f, "");
		SetPlayerActive(false);
	}
	if(asChild == "AreaActiveBrute_3")
	{
		ClearEnemyPatrolNodes("brute_3");
	
		AddEnemyPatrolNode("brute_3", "PathNodeArea_360", 0.001f, "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_361", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_364", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_365", 0.001f, "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_371", 0.001f, "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_373", 0.001f, "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_374", 0.001f, "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_284", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_292", 0.001f, "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_294", 0.001f, "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_289", 0.001f, "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_281", 0.001f, "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_195", 0.001f, "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_179", 0.001f, "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_319", 0.001f, "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_156", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_157", 0.001f, "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_330", 0.001f, "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_331", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_330", 0.001f, "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_157", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_34", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_1", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_33", 0.001f, "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_321", 0.001f, "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_140", 0.001f, "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_141", 0.001f, "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_158", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_320", 0.001f, "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_264", 0.001f, "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_280", 0.001f, "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_286", 0.001f, "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_287", 0.001f, "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_284", 0.001f, "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_374", 0.001f, "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_373", 0.001f, "");
		AddEnemyPatrolNode("brute_3", "PathNodeArea_370", 0.001f, "");
	
		SetEntityActive("brute_3", true);	
	}
}

void CollideAreaActiveGrunt(string &in asParent, string &in asChild, int alState)
{
	if(asChild == "AreaActiveGrunt_1")
	{
		ClearEnemyPatrolNodes("grunt_1");
		
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_35", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_36", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_37", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_38", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_39", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_40", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_41", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_42", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_43", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_44", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_45", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_46", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_47", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_48", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_49", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_50", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_51", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_52", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_53", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_54", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_55", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_56", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_57", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_58", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_59", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_60", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_61", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_62", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_63", 2.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_62", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_61", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_60", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_64", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_65", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_66", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_67", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_68", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_79", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_80", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_81", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_82", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_83", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_84", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_85", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_49", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_48", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_47", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_46", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_45", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_40", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_39", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_38", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_37", 0.001f, "");
		AddEnemyPatrolNode("grunt_1", "PathNodeArea_36", 0.001f, "");
		
		SetEntityActive("grunt_1", true);
		SetEntityActive("grunt_body_part1_1", false);
		SetEntityActive("grunt_body_part2_1", false);
		SetEntityActive("grunt_body_part3_1", false);
		
		PlayMusic("20_event_darkness", false, 1.0f, 0.0f, 10, true);
		AddTimer("panteffect", 0.6f, "TimerPlayerReactions");
		AddTimer("breatheffect", 2.0f, "TimerPlayerReactions");
		SetMessage("Jack", "09", 5.0f);
	}
	if(asChild == "AreaActiveGrunt_2")
	{
		ClearEnemyPatrolNodes("grunt_2");
		
		AddEnemyPatrolNode("grunt_2", "PathNodeArea_126", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_2", "PathNodeArea_116", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_2", "PathNodeArea_95", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_2", "PathNodeArea_97", 0.001f, "");
		AddEnemyPatrolNode("grunt_2", "PathNodeArea_98", 0.001f, "");
		AddEnemyPatrolNode("grunt_2", "PathNodeArea_99", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_2", "PathNodeArea_98", 0.001f, "");
		AddEnemyPatrolNode("grunt_2", "PathNodeArea_97", 0.001f, "");
		AddEnemyPatrolNode("grunt_2", "PathNodeArea_76", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_2", "PathNodeArea_95", 0.001f, "");
		AddEnemyPatrolNode("grunt_2", "PathNodeArea_116", 0.001f, "");
		AddEnemyPatrolNode("grunt_2", "PathNodeArea_125", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_2", "PathNodeArea_132", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_2", "PathNodeArea_135", 0.001f, "");
		AddEnemyPatrolNode("grunt_2", "PathNodeArea_137", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_2", "PathNodeArea_134", 0.001f, "");
		AddEnemyPatrolNode("grunt_2", "PathNodeArea_132", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_2", "PathNodeArea_127", 0.001f, "");
		
		SetEntityActive("grunt_2", true);
	}
	if(asChild == "AreaActiveGrunt_3")
	{
		ClearEnemyPatrolNodes("grunt_3");
	
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_47", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_48", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_49", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_50", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_84", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_83", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_82", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_81", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_80", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_79", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_78", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_77", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_76", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_92", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_93", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_94", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_95", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_96", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_97", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_98", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_99", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_98", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_97", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_96", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_95", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_104", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_105", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_106", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_115", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_116", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_117", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_124", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_125", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_126", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_127", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_131", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_132", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_134", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_135", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_136", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_135", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_134", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_318", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_317", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_316", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_315", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_300", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_299", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_298", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_297", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_296", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_295", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_300", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_315", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_318", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_134", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_135", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_136", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_137", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_138", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_139", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_138", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_137", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_136", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_135", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_134", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_132", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_131", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_127", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_126", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_125", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_124", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_117", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_116", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_115", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_106", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_95", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_93", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_92", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_76", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_85", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_49", 0.001f, "");
		AddEnemyPatrolNode("grunt_3", "PathNodeArea_48", 0.001f, "");
		
		SetEntityActive("grunt_3", true);	
	}
	if(asChild == "AreaActiveGrunt_4")
	{
		SetPropHealth("mansion_1", 0.0f);
		StartScreenShake(0.2f, 0.1f, 0.0f, 0.0f);
		PlayGuiSound("react_pant", 1.0f);
		GiveSanityDamage(5.0f, false);
		ClearEnemyPatrolNodes("grunt_4");
		
		AddEnemyPatrolNode("grunt_4", "PathNodeArea_157", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_4", "PathNodeArea_319", 0.001f, "");
		AddEnemyPatrolNode("grunt_4", "PathNodeArea_281", RandFloat(2.5f, 4.5f), "");
		AddEnemyPatrolNode("grunt_4", "PathNodeArea_286", 0.001f, "");
		AddEnemyPatrolNode("grunt_4", "PathNodeArea_320", 0.001f, "");
		AddEnemyPatrolNode("grunt_4", "PathNodeArea_159", 0.001f, "");
		AddEnemyPatrolNode("grunt_4", "PathNodeArea_160", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("grunt_4", "PathNodeArea_174", RandFloat(2.5f, 4.5f), "");
		AddEnemyPatrolNode("grunt_4", "PathNodeArea_160", 0.001f, "");
		AddEnemyPatrolNode("grunt_4", "PathNodeArea_496", RandFloat(1.5f, 2.5f), "");
		AddEnemyPatrolNode("grunt_4", "PathNodeArea_157", 0.001f, "");
		AddEnemyPatrolNode("grunt_4", "PathNodeArea_331", 0.001f, "");
		AddEnemyPatrolNode("grunt_4", "PathNodeArea_332", 0.001f, "");
		AddEnemyPatrolNode("grunt_4", "PathNodeArea_333", RandFloat(1.5f, 2.5f), "");
		AddEnemyPatrolNode("grunt_4", "PathNodeArea_331", 0.001f, "");
	
		SetEntityActive("grunt_4", true);
	}
}

void TouchMansionDoor(string &in asEntity)
{
	if(asEntity == "mansion_5") SetMessage("Mother", "07", 5.0f);
}

void TouchLittleStatue(string &in asEntity)
{
	AddTimer("fadeout", 7.5f, "TimerFadeScreen");
	AddTimer("fadeinactiveplayer", 10.0f, "TimerFadeScreen");
	SetPlayerActive(false);
	if(asEntity == "arabic_statue_1")
	{
		AddTimer("silver", 9.5f, "TimerHideStatues");
		SetMessage("Mother", "04", 7.5f);
		FadeLightTo("PointLight_8", 0,0,0,0, -1, 2);
		FadeLightTo("PointLight_9", 0,0,0,0, -1, 2);
		
		SetEntityActive("AreaFailMotherQuest", false);
		SetEntityPlayerInteractCallback("mansion_5", "", true);
	}
	if(asEntity == "arabic_statue_gold_1")
	{
		AddTimer("silver", 9.5f, "TimerHideStatues");
		SetMessage("Mother", "04", 7.5f);
		FadeLightTo("PointLight_8", 0,0,0,0, -1, 2);
		FadeLightTo("PointLight_9", 0,0,0,0, -1, 2);
		
		SetEntityActive("AreaFailMotherQuest", false);
		SetEntityPlayerInteractCallback("mansion_5", "", true);
	}
	if(asEntity == "arabic_statue_2")
	{
		AddTimer("gold", 9.5f, "TimerHideStatues");
		SetMessage("Mother", "05", 7.5f);	
	}
	if(asEntity == "arabic_statue_gold_2")
	{
		CompleteQuest("MotherMission1", "MotherMission1");
		CompleteQuest("MotherMission2", "MotherMission2");
		CompleteQuest("MotherMission3", "MotherMission3");
	
		AddTimer("premother", 8.5f, "TimerLoadWood");
		GiveSanityBoostSmall();
		SetMessage("Mother", "06", 8.5f);
		PlayMusic("02_music_box", false, 1.0f, 1.0f, 10, true);
		
		if(GetGlobalVarInt("FastQuestCount") == 1)
		{
			RemoveTimer("MotherQuestTimer");
		}
	}
}

void TouchShirt(string &in asEntity)
{
	AddTimer("fadeout", 9.5f, "TimerFadeScreen");
	AddTimer("fadeinactiveplayer", 12.0f, "TimerFadeScreen");
	AddTimer("part1", 11.5f, "TimerHideShirts");
	SetPlayerActive(false);
	SetMessage("Father", "04", 9.5f);
	SetSwingDoorLocked("mansion_4", false, false);
	FadeLightTo("PointLight_11", 0,0,0,0, -1, 2);
}

void TimerQuest(string &in asTimer)
{
	SetGlobalVarInt("FastQuestCount", 0);
}

void TimerHideShirts(string &in asTimer)
{
	if(asTimer == "part1")
	{
		AddQuest("FatherMission", "FatherMission");
	
		SetEntityActive("shirt_folded_white_grab_1", false);
		SetEntityActive("shirt_folded_white_grab_2", true);
		SetEntityActive("shirt_folded_white_grab_3", true);
		
		AddTimer("FatherQuestTimer", 59.9f, "TimerQuest");
	}
}

void TimerHideStatues(string &in asTimer)
{
	if(asTimer == "silver")
	{
		CompleteQuest("MotherMission1", "MotherMission1");
		AddQuest("MotherMission2", "MotherMission2");
		
		SetEntityActive("arabic_statue_1", false);
		SetEntityActive("arabic_statue_gold_1", false);
		SetEntityActive("arabic_statue_2", true);
		
		AddTimer("MotherQuestTimer", 59.9f, "TimerQuest");
	}
	if(asTimer == "gold")
	{
		CompleteQuest("MotherMission2", "MotherMission2");
		AddQuest("MotherMission3", "MotherMission3");
	
		SetEntityActive("arabic_statue_2", false);
		SetEntityActive("arabic_statue_gold_2", true);
		SetEntityActive("book_bible_3", true);
		SetEntityActive("book_bible_26", true);
		SetEntityActive("book_bible_27", true);
		SetEntityActive("book_bible_28", true);
		SetEntityActive("book_bible_29", true);
		SetEntityActive("book_bible_30", true);
	}
}

void CollideAreaDiscoverWineBarrel(string &in asParent, string &in asChild, int alState)
{
	AddTimer("resetspeedmul", 4.0f, "TimerStopLook");
	AddTimer("breath", 7.0f, "TimerPlayerReactions");
	SetPlayerMoveSpeedMul(0.1f);
	SetPlayerRunSpeedMul(0.1f);
	SetPlayerLookSpeedMul(0.1f);
	SetMessage("Jack", "13", 7.0f);
	StartPlayerLookAt("AreaWineBarrel", 1.1f, 1.1f, "");
}

void CollideAreaDiscoverGrunt(string &in asParent, string &in asChild, int alState)
{
	AddTimer("scareeffect", 0.001f, "TimerPlayerReactions");
	AddTimer("breatheffect", 4.49f, "TimerPlayerReactions");
	AddTimer("resetspeedmul", 4.5f, "TimerStopLook");
	SetPlayerMoveSpeedMul(0.1f);
	SetPlayerRunSpeedMul(0.1f);
	SetPlayerLookSpeedMul(0.1f);
	AddTimer("psbang", 1.41f, "TimerCreatePs");
	AddTimer("psbanggrunt", 2.83f, "TimerCreatePs");
	AddTimer("psbang", 3.1f, "TimerCreatePs");
	AddTimer("psbanggrunt", 4.299f, "TimerCreatePs");
	CreateParticleSystemAtEntity("psbang", "ps_hit_wood.ps", "cellar_wood01_3", false);
	PlaySoundAtEntity("soundbang", "lurker_hit_wood.snt", "cellar_wood01_3", 0.0f, false);
	PlaySoundAtEntity("gruntbang", "enemy/grunt/notice.snt", "cellar_wood01_3", 0.0f, false);
	SetMessage("Jack", "16", 5.5f);
	StartPlayerLookAt("cellar_wood01_3", 1.1f, 1.1f, "");
}

void TimerCreatePs(string &in asTimer)
{
	if(asTimer == "psbang")
	{
		CreateParticleSystemAtEntity("psbang", "ps_hit_wood.ps", "cellar_wood01_3", false);
		PlaySoundAtEntity("soundbang", "lurker_hit_wood.snt", "cellar_wood01_3", 0.0f, false);
		StartScreenShake(0.02f, 0.1f, 0.1f, 0.1f);
	}
	if(asTimer == "psbanggrunt")
	{
		PlaySoundAtEntity("gruntbang", "enemy/grunt/notice.snt", "cellar_wood01_3", 0.0f, false);
	}
}

void TimerSaySomething(string &in asTimer)
{
	if(asTimer == "jack01") SetMessage("Jack", "04", 5.0f);
	if(asTimer == "jack02") SetMessage("Jack", "05", 5.0f);
	if(asTimer == "jack03")	SetMessage("Jack", "08", 9.5f);
	if(asTimer == "jack04") SetMessage("Jack", "23", 5.0f);
	if(asTimer == "jack31") SetMessage("Jack", "31", 5.0f);
	if(asTimer == "jack32") SetMessage("Jack", "32", 5.0f);
	if(asTimer == "jack34") SetMessage("Jack", "34", 5.0f);
	if(asTimer == "jackmorenightmares") SetMessage("Jack", "MoreNightmares", 7.0f);
	if(asTimer == "woman02") SetMessage("Woman", "02", 5.0f);
}

void CheckCurrentVision()
{
	SetPlayerActive(false);
	if(GetGlobalVarInt("MotherQuest") == 0)
	{
		AddQuest("MotherMission1", "MotherMission1");
		SetEntityActive("AreaBookJump", true);
		AddTimer("activeplayer", 7.0f, "TimerStopLook");
		AddTimer("jack01", 8.0f, "TimerSaySomething");
		PlayMusic("02_music_box", false, 1.0f, 1.0f, 10, true);
		SetMessage("Mother", "02", 7.0f);
		SetEntityActive("AreaFailMotherQuest", true);
		SetupLoadScreen("LoadingHints", "03To04", 0, "game_loading_rose.jpg");
		SetEntityActive("block_1", true);
		SetEntityActive("web_1", true);
		SetEntityActive("block_3", true);
		SetEntityActive("armour_1", true);
		SetEntityActive("armour_2", true);
		SetEntityActive("armour_3", true);
		SetEntityActive("block_5", true);
		SetEntityActive("block_6", true);
		SetEntityActive("angel_36", true);
	}
	else if(GetGlobalVarInt("FatherQuest") == 0)
	{
		AddTimer("activeplayer", 7.0f, "TimerStopLook");
		AddTimer("jack02", 8.0f, "TimerSaySomething");
		SetMessage("Father", "02", 7.0f);
		PlayMusic("02_father_theme.ogg", false, 1.0f, 1.0f, 10, true);
		SetupLoadScreen("LoadingHints", "05To06", 0, "game_loading_trunk.jpg");
		SetEntityActive("block_1", true);
		SetEntityActive("web_1", true);
		SetEntityActive("block_3", true);
		SetEntityActive("armour_1", true);
		SetEntityActive("armour_2", true);
		SetEntityActive("armour_3", true);
		SetEntityActive("block_5", true);
		SetEntityActive("block_6", true);
		
		SetEntityActive("arabic_statue_1", false);
		SetEntityActive("arabic_statue_2", false);
		SetEntityActive("arabic_statue_gold_1", false);
		SetLightVisible("PointLight_8", false);
		SetLightVisible("PointLight_9", false);
		
		if(GetGlobalVarInt("MotherQuestFailed") == 1)
		{
			SetEntityActive("arabic_statue_3", true);
			SetEntityActive("arabic_statue_gold_3", true);
		}
	}
	else if(GetGlobalVarInt("StorageQuest") == 0)
	{
		AddTimer("activeplayer", 18.0f, "TimerStopLook");
		AddTimer("jack03", 8.5f, "TimerSaySomething");
		AddTimer("0", 28.681f, "TimerStopMusic");
		CheckPoint ("fromgrunt1", "PlayerStartArea_3", "CPGrunt1", "DeathHints", "StealthyAndEscape");
		SetMessage("Jack", "07", 8.5f);
		//SetEntityActive("AreaEscapeGrunt_1", true);
		SetEntityActive("block_1", true);
		SetEntityActive("web_1", true);
		SetEntityActive("block_3", true);
		SetEntityActive("armour_1", true);
		SetEntityActive("armour_2", true);
		SetEntityActive("armour_3", true);
		SetEntityActive("block_5", true);
		SetEntityActive("block_6", true);
		SetEntityActive("AreaActiveGrunt_2", true);
		PlayMusic("05_paper_transformation", false, 1.0f, 0.0f, 10, true);
		StartPlayerLookAt("AreaLookDeadGrunt", 1.8f, 1.8f, "");
		SetupLoadScreen("LoadingHints", "07To08", 0, "game_loading_hand.jpg");
		
		SetEntityActive("arabic_statue_1", false);
		SetEntityActive("arabic_statue_2", false);
		SetEntityActive("arabic_statue_gold_1", false);
		SetEntityActive("shirt_folded_white_grab_1", false);
		SetEntityActive("shirt_folded_white_grab_2", false);
		SetEntityActive("shirt_folded_white_grab_3", false);
		SetEntityActive("AreaFailMotherQuest", false);
		SetEntityActive("AreaFailFatherQuest", false);
		SetLightVisible("PointLight_8", false);
		SetLightVisible("PointLight_9", false);
		SetLightVisible("PointLight_11", false);
		
		SetLocalVarInt("StorageDoorOpened", 0);
		
		if(GetGlobalVarInt("FatherQuestFailed") == 1)
		{
			SetEntityActive("violin_1", false);
			SetEntityActive("violin_2", true);
		}
	}
	else if(GetGlobalVarInt("WineQuest") == 0)
	{
		if(GetGlobalVarInt("FatherQuestFailed") == 0)
		{
			SetEntityActive("potion_sanity_1", true);
			SetEntityActive("potion_oil_1", true);
			SetEntityActive("tinderbox_1", true);
			SetEntityActive("tinderbox_2", true);
		}
		else
		{
			SetEntityActive("tinderbox_1", true);
			SetEntityActive("tinderbox_2", true);
		}
		AddQuest("WineMission1", "WineMission1");
		AddTimer("activeplayer", 7.0f, "TimerStopLook");
		CheckPoint ("insidewinevision", "PlayerStartArea_4", "CPWineVision", "DeathHints", "BeCareful");
		SetEntityActive("block_1", false);
		SetEntityActive("web_1", false);
		SetEntityActive("block_3", true);
		SetEntityActive("armour_1", true);
		SetEntityActive("armour_2", true);
		SetEntityActive("armour_3", true);
		SetEntityActive("block_5", true);
		SetEntityActive("block_6", false);
		SetEntityActive("chair_nice02_5", false);
		SetEntityActive("AreaEscapeGrunt_1", false);
		SetEntityActive("AreaActiveGrunt_1", false);
		SetEntityActive("AreaActiveGrunt_2", false);
		SetEntityActive("AreaDiscoverStorageDoor", false);
		SetEntityActive("AreaDiscoverWineBarrel", true);
		SetEntityActive("AreaDiscoverGrunt", true);
		SetEntityActive("fakecontainer_1", true);
		SetEntityActive("FadeContainerArea_1", true);
		SetSwingDoorLocked("mansion_2", false, false);
		SetSwingDoorClosed("cellar_wood01_3", true, false);
		SetSwingDoorLocked("cellar_wood01_3", true, false);
		SetSwingDoorLocked("castle_1", false, false);
		SetLampLit("hanging_lantern_ceiling_10", false, false);
		SetLampLit("candle_floor_small_108", false, false);
		SetLampLit("candle_floor_small_107", false, false);
		SetLampLit("hanging_lantern_ceiling_1", true, false);
		SetLampLit("candle_floor_small_110", true, false);
		SetLampLit("candle_floor_small_109", true, false);
		StartPlayerLookAt("wine02_4", 1.1f, 1.1f, "");
		SetMessage("Jack", "12", 10.0f);
		SetupLoadScreen("LoadingHints", "10To11", 0, "game_loading_rose.jpg");
		
		SetEntityCustomFocusCrossHair("FadeContainerArea_1", "Pick");
		SetEntityCustomFocusCrossHair("FadeContainerArea_2", "Pick");
		
		SetEntityActive("arabic_statue_1", false);
		SetEntityActive("arabic_statue_2", false);
		SetEntityActive("arabic_statue_gold_1", false);
		SetEntityActive("shirt_folded_white_grab_1", false);
		SetEntityActive("shirt_folded_white_grab_2", false);
		SetEntityActive("shirt_folded_white_grab_3", false);
		SetEntityActive("AreaFailMotherQuest", false);
		SetEntityActive("AreaFailFatherQuest", false);
		SetEntityActive("work_desk_door_1", false);
		SetLightVisible("PointLight_8", false);
		SetLightVisible("PointLight_9", false);
		SetLightVisible("PointLight_11", false);
	}
	else if(GetGlobalVarInt("LibraryQuest") == 0)
	{
		if(GetGlobalVarInt("MotherQuestFailed") == 1)
		{
			SetEntityActive("arabic_statue_giant_1", true);
			SetEntityActive("arabic_statue_giant_2", true);
			SetEntityActive("AreaActiveBrute_2", true);
		}
		SetEntityActive("AreaBookJump", false);
		AddTimer("activeplayer", 7.0f, "TimerStopLook");
		CheckPoint ("insidelibraryvision", "PlayerStartArea_1", "CPLibraryVision", "DeathHints", "NightmaresAreClose");
		SetLampLit("orb_pedestal_1", true, true);
		SetLampLit("hanging_lantern_ceiling_10", false, false);
		SetLampLit("hanging_lantern_ceiling_8", false, false);
		SetLampLit("hanging_lantern_ceiling_1", false, false);
		SetLampLit("candle_floor_1", false, false);
		SetLampLit("candle_floor_no_light_4", false, false);
		SetLampLit("candle_floor_no_light_5", false, false);
		SetLampLit("candle_floor_no_light_6", false, false);
		SetLampLit("candle_floor_no_light_7", false, false);
		SetLampLit("candle_floor_no_light_8", false, false);
		SetLampLit("candle_floor_small_110", false, false);
		SetLampLit("candle_floor_small_109", false, false);
		SetLampLit("candle_floor_small_108", false, false);
		SetLampLit("candle_floor_small_107", false, false);
		SetLampLit("candle_floor_small_102", false, false);
		SetLampLit("hanging_lantern_wall_1", false, false);
		SetLampLit("torch_static01_33", false, false);
		SetLampLit("torch_static01_24", false, false);
		SetLampLit("torch_static01_23", false, false);
		SetEntityActive("AreaWineBarrel", false);
		SetEntityActive("AreaEscapeGrunt_1", false);
		SetEntityActive("AreaEscapeBrute_1", false);
		SetEntityActive("AreaEscapeBrute_2", false);
		SetEntityActive("AreaActiveGrunt_1", false);
		SetEntityActive("AreaActiveGrunt_2", false);
		SetEntityActive("AreaActiveGrunt_3", true);
		SetEntityActive("AreaActiveGrunt_4", false);
		SetEntityActive("block_1", false);
		SetEntityActive("web_1", false);
		SetEntityActive("block_3", true);
		SetEntityActive("armour_1", true);
		SetEntityActive("armour_2", true);
		SetEntityActive("armour_3", true);
		SetEntityActive("block_5", true);
		SetEntityActive("block_6", false);
		SetEntityActive("shelf_high02_1", false);
		SetEntityActive("grunt_body_part3_1", false);
		SetEntityActive("grunt_body_part2_1", false);
		SetEntityActive("grunt_body_part1_1", false);
		SetEntityActive("armchair_3", false);
		SetEntityActive("armchair_4", false);
		SetEntityActive("armchair_5", false);
		SetEntityActive("armchair_6", false);
		SetEntityActive("stool_wood_8", false);
		SetEntityActive("stool_wood_7", false);
		SetEntityActive("stool_wood_6", false);
		SetEntityActive("stool_wood_5", false);
		SetEntityActive("stool_wood_4", false);
		SetEntityActive("stool_wood_3", false);
		SetSwingDoorClosed("mansion_1", true, true);
		SetSwingDoorLocked("mansion_1", true, true);
		SetSwingDoorLocked("mansion_4", false, false);
		SetSwingDoorLocked("mansion_8", false, false);
		StartPlayerLookAt("ceremony_knife_1", 1.0f, 1.0f, "");
		SetMessage("Jack", "21", 8.5f);
		SetupLoadScreen("LoadingHints", "12To13", 0, "game_loading_water.jpg");
		
		SetEntityActive("arabic_statue_1", false);
		SetEntityActive("arabic_statue_2", false);
		SetEntityActive("arabic_statue_gold_1", false);
		SetEntityActive("shirt_folded_white_grab_1", false);
		SetEntityActive("shirt_folded_white_grab_2", false);
		SetEntityActive("shirt_folded_white_grab_3", false);
		SetEntityActive("AreaFailMotherQuest", false);
		SetEntityActive("AreaFailFatherQuest", false);
		SetEntityActive("work_desk_door_1", false);
		SetLightVisible("PointLight_8", false);
		SetLightVisible("PointLight_9", false);
		SetLightVisible("PointLight_11", false);
		
		for(int i=1; i<=15; i++)
		{
			SetEntityActive("slime_anim_ceiling_" + i, true);
			SetEntityActive("slime_anim_wall_" + i, true);
		}
		AddTimer("Active", 2.0f, "TimerFixSlimes");
	}
	else if(GetGlobalVarInt("LabQuest") == 0)
	{
		AddTimer("activeplayer", 7.0f, "TimerStopLook");
		AddTimer("jack31", 7.0f, "TimerSaySomething");
		CheckPoint ("insidelabvision", "PlayerStartArea_7", "CPLabVision", "DeathHints", "HushNow");
		AddTimer("randpianoplays", 5.0f, "TimerRandPianoPlays");
		SetLampLit("candle_floor_small_1", true, false);
		SetLampLit("hanging_lantern_ceiling_9", false, false);
		SetLampLit("torch_static01_34", false, false);
		SetEntityActive("AreaWineBarrel", false);
		SetEntityActive("AreaEscapeGrunt_1", false);
		SetEntityActive("AreaEscapeBrute_1", false);
		SetEntityActive("AreaEscapeBrute_2", false);
		SetEntityActive("AreaEscapeBrute_3", false);
		SetEntityActive("AreaActiveGrunt_3", false);
		SetEntityActive("AreaActiveBrute_3", false);
		SetEntityActive("block_1", false);
		SetEntityActive("web_1", false);
		SetEntityActive("block_3", false);
		SetEntityActive("armour_1", false);
		SetEntityActive("armour_2", false);
		SetEntityActive("armour_3", false);
		SetEntityActive("block_5", false);
		SetEntityActive("block_6", false);
		SetEntityActive("AreaDiscoverPiano", true);
		SetEntityActive("key_tower_1", true);
		SetEntityActive("AreaActiveAngel_1", true);
		//SetEntityActive("AreaActiveAngel_2", true);
		//SetEntityActive("AreaActiveSuitor_1", true);
		SetSwingDoorLocked("cellar_wood01_1", true, false);
		SetMessage("Woman", "01", 7.0f);
		StartPlayerLookAt("slime_pile_2", 0.9f, 0.9f, "");
		SetupLoadScreen("LoadingHints", "14To15", 0, "game_loading_girl.jpg");
		
		SetEntityActive("arabic_statue_1", false);
		SetEntityActive("arabic_statue_2", false);
		SetEntityActive("arabic_statue_gold_1", false);
		SetEntityActive("shirt_folded_white_grab_1", false);
		SetEntityActive("shirt_folded_white_grab_2", false);
		SetEntityActive("shirt_folded_white_grab_3", false);
		SetEntityActive("AreaFailMotherQuest", false);
		SetEntityActive("AreaFailFatherQuest", false);
		SetEntityActive("work_desk_door_1", false);
		SetLightVisible("PointLight_8", false);
		SetLightVisible("PointLight_9", false);
		SetLightVisible("PointLight_11", false);
		SetEntityActive("block_3", false);
		SetEntityActive("armour_1", false);
		SetEntityActive("armour_2", false);
		SetEntityActive("armour_3", false);
		if(GetGlobalVarInt("StatuesAchievement") == 1) PlaySoundAtEntity("note_generic_1_sound", "02_statue_terror.snt", "note_generic_1", 0.0f, true);
	}
	else if(GetGlobalVarInt("LabQuest") == 1 && GetGlobalVarInt("LabQuestFailed") == 1)
	{
		RemoveTimer("suitor1");
		SetLevelDoorLocked("level_wood_double_1", true);
		SetMessage("Woman", "MakeItRight", 7.0f);
		AddTimer("activeplayer", 5.0f, "TimerStopLook");
		AddTimer("painting01", 1.0f, "TimerReplaceEntity");
		AddQuest("MusicSheetMission", "MusicSheetMission");
		CheckPoint ("afteroutside", "PlayerStartArea_7", "CPOutsideVision", "DeathHints", "FollowThePath");
		
		SetupLoadScreen("LoadingHints", "HouseToWoods", 0, "game_loading_girl.jpg");
		
		SetLampLit("candlestick_tri_3", false, false);
		SetLampLit("candlestick_tri_4", false, false);
		SetLampLit("candlestick_tri_5", false, false);
		SetLampLit("candlestick_tri_6", false, false);
		SetLampLit("candlestick_tri_7", false, false);
		SetLampLit("candlestick_tri_8", false, false);
		SetLampLit("candlestick_wall_1", false, false);
		SetLampLit("candlestick_wall_5", false, false);
		SetLampLit("candlestick_wall_12", false, false);
		SetLampLit("candlestick_wall_13", false, false);
		SetLampLit("candlestick_wall_41", false, false);
		SetLampLit("candlestick_wall_42", false, false);
		for(int a=1; a<=42; a++) SetEntityActive("angel_" + a, true);
		for(int b=1; b<=8; b++) SetEntityActive("AreaAngelKill_" + b, true);
	}
}

void TimerFixSlimes(string &in asTimer)
{
	if(asTimer == "Active")
	{
		SetEntityActive("slime_anim_wall_2", false);
		SetEntityActive("slime_anim_wall_6", false);
		if(GetGlobalVarInt("MotherQuestFailed") == 0) SetEntityActive("slime_anim_wall_10", false);
		SetEntityActive("slime_anim_wall_11", false);
		SetEntityActive("slime_anim_wall_14", false);
		SetEntityActive("slime_anim_ceiling_3", false);
		SetEntityActive("slime_anim_ceiling_7", false);
		SetEntityActive("slime_anim_ceiling_8", false);
		if(GetGlobalVarInt("MotherQuestFailed") == 0) SetEntityActive("slime_anim_ceiling_10", false);
		SetEntityActive("slime_anim_ceiling_11", false);
		SetEntityActive("slime_anim_ceiling_13", false);
		SetEntityActive("slime_anim_ceiling_14", false);
	}
	else if(asTimer == "Sounds")
	{
		StopSound("slime_anim_wall_sound_2", 0.1f);
		StopSound("slime_anim_wall_sound_6", 0.1f);
		if(GetGlobalVarInt("MotherQuestFailed") == 0) StopSound("slime_anim_wall_sound_10", 0.1f);
		StopSound("slime_anim_wall_sound_11", 0.1f);
		StopSound("slime_anim_wall_sound_14", 0.1f);
		StopSound("slime_anim_ceiling_sound_3", 0.1f);
		StopSound("slime_anim_ceiling_sound_7", 0.1f);
		StopSound("slime_anim_ceiling_sound_8", 0.1f);
		if(GetGlobalVarInt("MotherQuestFailed") == 0) StopSound("slime_anim_ceiling_sound_10", 0.1f);
		StopSound("slime_anim_ceiling_sound_11", 0.1f);
		StopSound("slime_anim_ceiling_sound_13", 0.1f);
		StopSound("slime_anim_ceiling_sound_14", 0.1f);
	}
}

void TimerRandPianoPlays(string &in asTimer)
{
	if(asTimer == "randpianoplays")
	{
		SetLocalVarInt("RandPianoPlaysVar", RandInt(1, 4));
		if(GetLocalVarInt("RandPianoPlaysVar") == 1) PlaySoundAtEntity("randpianoplayssound", "03_waking_up", "piano_1", 1.0f, false);
		if(GetLocalVarInt("RandPianoPlaysVar") == 2) PlaySoundAtEntity("randpianoplayssound", "general_piano01", "piano_1", 1.0f, false);
		if(GetLocalVarInt("RandPianoPlaysVar") == 3) PlaySoundAtEntity("randpianoplayssound", "general_piano02", "piano_1", 1.0f, false);
		if(GetLocalVarInt("RandPianoPlaysVar") == 4) PlaySoundAtEntity("randpianoplayssound", "general_piano03", "piano_1", 1.0f, false);
		AddTimer("randpianoplays", RandFloat(23.0f, 26.0f), "TimerRandPianoPlays");
	}
	if(asTimer == "randpianoplaysstop")
	{
		RemoveTimer("randpianoplays");
		StopSound("randpianoplayssound", 0.1f);
	}
}

void CollideAreaActiveSuitor(string &in asParent, string &in asChild, int alState)
{
	if(asChild == "AreaActiveSuitor_1")
	{
		if(alState == 1 || GetLocalVarInt("FirstLetterSpawned") == 0)
		{
			PlayGuiSound("impact_paper_med3.ogg", 0.5f);
			SetEntityActive("note_letter_1", true);
			AddPropForce("note_letter_1", 0.0f, 0.0f, -2.0f, "world");
			AddTimer("react_breath", 1.0f, "TimerPlayerReactions");
			StartPlayerLookAt("note_letter_1", 2.5f, 2.5f, "");
			SetLocalVarInt("FirstLetterSpawned", 1);
		}
		else
		{
			AddTimer("suitor1", RandFloat(2.0f, 3.0f), "TimerActiveSuitor");
			//SetMessage("Jack", "36", 6.0f);
			SetPropActiveAndFade("slime_pile_1", true, 1.0f);
			SetPropActiveAndFade("slime_pile_2", true, 1.0f);
			SetPropActiveAndFade("slime_egg_1", true, 1.0f);
			PlaySoundAtEntity("", "slime_loop", "slime_pile_1", 1.0f, true);
			PlaySoundAtEntity("", "slime_loop", "slime_pile_2", 1.0f, true);
			PlaySoundAtEntity("", "slime_loop", "slime_egg_1", 1.0f, true);
			SetEntityActive("SlimeDamageArea_3", true);
			SetEntityActive("SlimeDamageArea_2", true);
			SetEntityActive("SlimeDamageArea_1", true);
			SetEntityActive(asChild, false);
		}
	}
}

void TimerActiveSuitor(string &in asTimer)
{
	if(asTimer == "suitor1")
	{
		if(QuestIsAdded("LabMission") == false) AddQuest("LabMission", "LabMission");
	
		SetMessage("Jack", "35", 8.0f);
		
		AddTimer("scare", 1.0f, "TimerPlayerReactions");
		AddTimer("breath", 2.5f, "TimerPlayerReactions");
	
		ClearEnemyPatrolNodes("suitor_1");
	
		AddEnemyPatrolNode("suitor_1", "PathNodeArea_377", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("suitor_1", "PathNodeArea_398", 0.001f, "");
		AddEnemyPatrolNode("suitor_1", "PathNodeArea_402", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("suitor_1", "PathNodeArea_420", 0.001f, "");
		AddEnemyPatrolNode("suitor_1", "PathNodeArea_407", 0.001f, "");
		AddEnemyPatrolNode("suitor_1", "PathNodeArea_409", 0.001f, "");
		AddEnemyPatrolNode("suitor_1", "PathNodeArea_283", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("suitor_1", "PathNodeArea_289", 3.001f, "");
		AddEnemyPatrolNode("suitor_1", "PathNodeArea_283", 0.001f, "");
		AddEnemyPatrolNode("suitor_1", "PathNodeArea_409", 0.001f, "");
		AddEnemyPatrolNode("suitor_1", "PathNodeArea_407", 0.001f, "");
		AddEnemyPatrolNode("suitor_1", "PathNodeArea_402", 0.001f, "");
		AddEnemyPatrolNode("suitor_1", "PathNodeArea_398", 0.001f, "");
		AddEnemyPatrolNode("suitor_1", "PathNodeArea_394", 0.001f, "");
		AddEnemyPatrolNode("suitor_1", "PathNodeArea_375", 1.001f, "");
		
		SetEntityActive("suitor_1", true);
		
		ClearEnemyPatrolNodes("suitor_2");
		
		AddEnemyPatrolNode("suitor_2", "PathNodeArea_163", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("suitor_2", "PathNodeArea_161", 0.001f, "");
		AddEnemyPatrolNode("suitor_2", "PathNodeArea_160", 0.001f, "");
		AddEnemyPatrolNode("suitor_2", "PathNodeArea_159", 0.001f, "");
		AddEnemyPatrolNode("suitor_2", "PathNodeArea_321", 2.001f, "");
		AddEnemyPatrolNode("suitor_2", "PathNodeArea_1", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("suitor_2", "PathNodeArea_34", 2.001f, "");
		AddEnemyPatrolNode("suitor_2", "PathNodeArea_157", RandFloat(3.5f, 6.5f), "");
		AddEnemyPatrolNode("suitor_2", "PathNodeArea_159", 0.001f, "");
		AddEnemyPatrolNode("suitor_2", "PathNodeArea_160", 0.001f, "");
		AddEnemyPatrolNode("suitor_2", "PathNodeArea_161", 0.001f, "");
		AddEnemyPatrolNode("suitor_2", "PathNodeArea_162", 0.001f, "");
		
		SetEntityActive("suitor_2", true);
		
		if(GetGlobalVarInt("LibraryQuestFailed") == 1 || GetGlobalVarInt("FatherQuestFailed") == 1)
		{
			ClearEnemyPatrolNodes("brute_1");
			
			AddEnemyPatrolNode("brute_1", "PathNodeArea_1", 0.001f, "");
			AddEnemyPatrolNode("brute_1", "PathNodeArea_7", RandFloat(3.5f, 6.5f), "");
			AddEnemyPatrolNode("brute_1", "PathNodeArea_1", 0.001f, "");
			AddEnemyPatrolNode("brute_1", "PathNodeArea_34", RandFloat(3.5f, 6.5f), "");
			AddEnemyPatrolNode("brute_1", "PathNodeArea_141", 0.001f, "");
			AddEnemyPatrolNode("brute_1", "PathNodeArea_323", 0.001f, "");
			AddEnemyPatrolNode("brute_1", "PathNodeArea_329", 3.001f, "");
			AddEnemyPatrolNode("brute_1", "PathNodeArea_141", 0.001f, "");
			AddEnemyPatrolNode("brute_1", "PathNodeArea_142", 0.001f, "");
			AddEnemyPatrolNode("brute_1", "PathNodeArea_144", RandFloat(3.5f, 6.5f), "");
			AddEnemyPatrolNode("brute_1", "PathNodeArea_147", 3.001f, "");
			AddEnemyPatrolNode("brute_1", "PathNodeArea_144", 0.001f, "");
			AddEnemyPatrolNode("brute_1", "PathNodeArea_142", 0.001f, "");
			AddEnemyPatrolNode("brute_1", "PathNodeArea_157", 0.001f, "");
			AddEnemyPatrolNode("brute_1", "PathNodeArea_331", RandFloat(3.5f, 6.5f), "");
			AddEnemyPatrolNode("brute_1", "PathNodeArea_157", 0.001f, "");
			AddEnemyPatrolNode("brute_1", "PathNodeArea_321", 0.001f, "");
			AddEnemyPatrolNode("brute_1", "PathNodeArea_21", 0.001f, "");
			AddEnemyPatrolNode("brute_1", "PathNodeArea_23", 0.001f, "");
			AddEnemyPatrolNode("brute_1", "PathNodeArea_26", 3.001f, "");
			AddEnemyPatrolNode("brute_1", "PathNodeArea_23", 0.001f, "");
			AddEnemyPatrolNode("brute_1", "PathNodeArea_21", RandFloat(3.5f, 6.5f), "");
			
			SetEntityActive("brute_1", true);	
		}
		if(GetGlobalVarInt("WineQuestFailed") == 1 || GetGlobalVarInt("StorageQuestFailed") == 1)
		{
			ClearEnemyPatrolNodes("grunt_2");
		
			AddEnemyPatrolNode("grunt_2", "PathNodeArea_126", 3.001f, "");
			AddEnemyPatrolNode("grunt_2", "PathNodeArea_131", 0.001f, "");
			AddEnemyPatrolNode("grunt_2", "PathNodeArea_132", 0.001f, "");
			AddEnemyPatrolNode("grunt_2", "PathNodeArea_135", RandFloat(3.5f, 6.5f), "");
			AddEnemyPatrolNode("grunt_2", "PathNodeArea_318", 0.001f, "");
			AddEnemyPatrolNode("grunt_2", "PathNodeArea_299", RandFloat(3.5f, 6.5f), "");
			AddEnemyPatrolNode("grunt_2", "PathNodeArea_306", 0.001f, "");
			AddEnemyPatrolNode("grunt_2", "PathNodeArea_284", 0.001f, "");
			AddEnemyPatrolNode("grunt_2", "PathNodeArea_371", 0.001f, "");
			AddEnemyPatrolNode("grunt_2", "PathNodeArea_362", RandFloat(3.5f, 6.5f), "");
			AddEnemyPatrolNode("grunt_2", "PathNodeArea_373", 0.001f, "");
			AddEnemyPatrolNode("grunt_2", "PathNodeArea_287", RandFloat(3.5f, 6.5f), "");
			AddEnemyPatrolNode("grunt_2", "PathNodeArea_295", 0.001f, "");
			AddEnemyPatrolNode("grunt_2", "PathNodeArea_134", 0.001f, "");
			AddEnemyPatrolNode("grunt_2", "PathNodeArea_136", 0.001f, "");
			AddEnemyPatrolNode("grunt_2", "PathNodeArea_137", RandFloat(3.5f, 6.5f), "");
			AddEnemyPatrolNode("grunt_2", "PathNodeArea_135", 0.001f, "");
			AddEnemyPatrolNode("grunt_2", "PathNodeArea_132", 0.001f, "");
			AddEnemyPatrolNode("grunt_2", "PathNodeArea_131", 0.001f, "");
			AddEnemyPatrolNode("grunt_2", "PathNodeArea_127", 0.001f, "");
			AddEnemyPatrolNode("grunt_2", "PathNodeArea_124", RandFloat(3.5f, 6.5f), "");

			SetEntityActive("grunt_2", true);	
		}
	}
}

void TimerStopMusic(string &in asTimer)
{
	if(asTimer == "0") StopMusic(0.0f, 0);
}

void CPBrute1(string &in asName, int alCount)
{
	if(GetGlobalVarInt("ItemsAchievement") == 1)
		if(GetPlayerLampOil() <= 20.0f)
			AddPlayerLampOil(20.0f);
	if(GetGlobalVarInt("FastSeekerAchievement") == 1)
		SetPlayerRunSpeedMul(1.175f);
	if(GetGlobalVarInt("WardrobeAchievement") == 1)
		SetPlayerJumpForceMul(1.175f);
	if(GetGlobalVarInt("NoDeathAchievement") == 1)
		SetPlayerHealth(100.1f);
	if(GetGlobalVarInt("SanityAchievement") == 1)
		SetPlayerSanity(100.1f);
	
	AddTimer("brute1", 3.0f, "TimerActiveBrute");
	
	PlayMusic("02_house_piano_theme", true, 0.55f, 1.0f, 0, false);
	
	ResetProp("mansion_4");
	ResetProp("mansion_5");
	
	AddGlobalVarInt("GlobalDeathCount", 1);
}

void CPWineVision(string &in asName, int alCount)
{
	if(GetGlobalVarInt("ItemsAchievement") == 1)
		if(GetPlayerLampOil() <= 20.0f)
			AddPlayerLampOil(20.0f);
	if(GetGlobalVarInt("FastSeekerAchievement") == 1)
		SetPlayerRunSpeedMul(1.175f);
	if(GetGlobalVarInt("WardrobeAchievement") == 1)
		SetPlayerJumpForceMul(1.175f);
	if(GetGlobalVarInt("NoDeathAchievement") == 1)
		SetPlayerHealth(100.1f);
	if(GetGlobalVarInt("SanityAchievement") == 1)
		SetPlayerSanity(100.1f);
	CompleteQuest("WineMission1", "WineMission1");
	CompleteQuest("WineMission2", "WineMission2");
	CompleteQuest("WineMission3", "WineMission3");
	SetEntityActive("mansion_1", true);
	SetEntityActive("AreaRollBarrel", false);
	SetGlobalVarInt("WineQuestFailed", 1);
	SetGlobalVarInt("WineQuest", 1);
	AddGlobalVarInt("HouseDeathCount", 1);
	AddTimer("wine", 1.5f, "TimerLoadWood");
}

void CPLibraryVision(string &in asName, int alCount)
{
	if(GetGlobalVarInt("ItemsAchievement") == 1)
		if(GetPlayerLampOil() <= 20.0f)
			AddPlayerLampOil(20.0f);
	if(GetGlobalVarInt("FastSeekerAchievement") == 1)
		SetPlayerRunSpeedMul(1.175f);
	if(GetGlobalVarInt("WardrobeAchievement") == 1)
		SetPlayerJumpForceMul(1.175f);
	if(GetGlobalVarInt("NoDeathAchievement") == 1)
		SetPlayerHealth(100.1f);
	if(GetGlobalVarInt("SanityAchievement") == 1)
		SetPlayerSanity(100.1f);
	AddGlobalVarInt("HouseDeathCount", 1);
	AddEntityCollideCallback("Player", "AreaActiveGrunt_3", "CollideAreaActiveGrunt", true, 1);
	PlayMusic("02_amb_strange", true, 0.8f, 0.1f, 0, false);
	if(GetGlobalVarInt("MotherQuestFailed") == 1)
	{
		AddEntityCollideCallback("Player", "AreaActiveBrute_3", "CollideAreaActiveBrute", true, 1);
		SetEntityActive("AreaActiveBrute_3", true);
	}
}

void CPLabVision(string &in asName, int alCount)
{
	if(GetGlobalVarInt("ItemsAchievement") == 1)
		if(GetPlayerLampOil() <= 20.0f)
			AddPlayerLampOil(20.0f);
	if(GetGlobalVarInt("FastSeekerAchievement") == 1)
		SetPlayerRunSpeedMul(1.175f);
	if(GetGlobalVarInt("WardrobeAchievement") == 1)
		SetPlayerJumpForceMul(1.175f);
	if(GetGlobalVarInt("NoDeathAchievement") == 1)
		SetPlayerHealth(100.1f);
	if(GetGlobalVarInt("SanityAchievement") == 1)
		SetPlayerSanity(100.1f);
	AddGlobalVarInt("HouseDeathCount", 1);
	AddTimer("suitor1", RandFloat(5.0f, 7.5f), "TimerActiveSuitor");
	PlayMusic("02_strange", true, 0.55f, 1.0f, 0, false);
}

void CPGrunt1(string &in asName, int alCount)
{
	if(GetGlobalVarInt("ItemsAchievement") == 1)
		if(GetPlayerLampOil() <= 20.0f)
			AddPlayerLampOil(20.0f);
	if(GetGlobalVarInt("FastSeekerAchievement") == 1)
		SetPlayerRunSpeedMul(1.175f);
	if(GetGlobalVarInt("WardrobeAchievement") == 1)
		SetPlayerJumpForceMul(1.175f);
	if(GetGlobalVarInt("NoDeathAchievement") == 1)
		SetPlayerHealth(100.1f);
	if(GetGlobalVarInt("SanityAchievement") == 1)
		SetPlayerSanity(100.1f);
	AddEntityCollideCallback("Player", "AreaActiveGrunt_1", "CollideAreaActiveGrunt", true, 1);
	AddEntityCollideCallback("Player", "AreaActiveGrunt_2", "CollideAreaActiveGrunt", true, 1);
	
	ResetProp("prison_section_plain_3");
	ResetProp("cellar_wood01_3");
	ResetProp("cellar_wood01_2");
	ResetProp("castle_1");
	
	AddGlobalVarInt("GlobalDeathCount", 1);
}

void CPOutsideVision(string &in asName, int alCount)
{
	if(GetGlobalVarInt("ItemsAchievement") == 1)
		if(GetPlayerLampOil() <= 20.0f)
			AddPlayerLampOil(20.0f);
	if(GetGlobalVarInt("FastSeekerAchievement") == 1)
		SetPlayerRunSpeedMul(1.175f);
	if(GetGlobalVarInt("WardrobeAchievement") == 1)
		SetPlayerJumpForceMul(1.175f);
	if(GetGlobalVarInt("NoDeathAchievement") == 1)
		SetPlayerHealth(100.1f);
	if(GetGlobalVarInt("SanityAchievement") == 1)
		SetPlayerSanity(100.1f);
	AddTimer("lab", 0.2f, "TimerLoadWood");																			  
}

void CollideAreaFailMotherQuest(string &in asParent, string &in asChild, int alState)
{
	if(alState == -1)
	{
	
	}
	else if(alState == 1)
	{
		CompleteQuest("MotherMission1", "MotherMission1");
		CompleteQuest("MotherMission2", "MotherMission2");
		CompleteQuest("MotherMission3", "MotherMission3");
	
		AddTimer("premother", 6.0f, "TimerLoadWood");
		PlayMusic("02_piano_eerie_stinger01", false, 0.7f, 0.0f, 10, true);
		SetPlayerActive(false);
		SetMessage("Mother", "03", 6.0f);
		SetGlobalVarInt("MotherQuestFailed", 1);
	}
}

void TimerLoadWood(string &in asTimer)
{
	if(asTimer == "premother")
	{
		AddTimer("mother", 1.5f, "TimerLoadWood");
		SetGlobalVarInt("MotherQuest", 1);
		StartEffectFlash(1.5f, 1.0f, 2.0f);
		StopMusic(1.49f, 0);
		StopMusic(1.49f, 10);
		
		SetPropActiveAndFade("arabic_statue_gold_2", false, 1.5f);
		SetPropActiveAndFade("book_bible_3", false, 1.5f);
		SetPropActiveAndFade("book_bible_26", false, 1.5f);
		SetPropActiveAndFade("book_bible_27", false, 1.5f);
		SetPropActiveAndFade("book_bible_28", false, 1.5f);
		SetPropActiveAndFade("book_bible_29", false, 1.5f);
		SetPropActiveAndFade("book_bible_30", false, 1.5f);
	}
	if(asTimer == "prefather")
	{
		AddTimer("father", 1.5f, "TimerLoadWood");
		SetGlobalVarInt("FatherQuest", 1);
		StartEffectFlash(1.5f, 1.0f, 2.0f);
		StopMusic(1.49f, 0);
		StopMusic(1.49f, 10);
	}
	if(asTimer == "prestorage")
	{
		AddTimer("storage", 1.5f, "TimerLoadWood");
		GiveSanityBoostSmall();
		SetGlobalVarInt("StorageQuest", 1);
		StartEffectFlash(1.5f, 1.0f, 2.0f);
	}
	if(asTimer == "prewine")
	{
		AddTimer("wine", 5.5f, "TimerLoadWood");
		GiveSanityBoostSmall();
		SetGlobalVarInt("WineQuest", 1);
		SetMessage("Jack", "19", 5.0f);
		SetPlayerActive(false);
	}
	if(asTimer == "prelibrary")
	{
		AddTimer("", 5.0f, "TimerStopLook");
		GiveSanityBoostSmall();
		SetGlobalVarInt("LibraryQuest", 1);
		SetPlayerActive(false);
		StartPlayerLookAt("AreaOrbBook", 1.0f, 1.0f, "");
		if(GetGlobalVarInt("LibraryQuestFailed") == 1)
		{
			AddTimer("library", 6.1f, "TimerLoadWood");
			PlayMusic("15_puzzle_hole", false, 1.0f, 1.5f, 10, false);
			SetMessage("Jack", "28", 6.0f);
		}
		else 
		{
			AddTimer("library", 7.0f, "TimerLoadWood");
			PlayMusic("22_puzzle_orb", false, 1.0f, 1.5f, 10, false);
			SetMessage("Jack", "29", 7.0f);
		}
	}
	if(asTimer == "prelab")
	{
		SetGlobalVarInt("LabQuest", 1);
		SetPlayerActive(false);
		if(GetGlobalVarInt("LabQuestFailed") == 1)
		{
			AddTimer("laboutside", 0.1f, "TimerLoadWood");
			PlayGuiSound("door_level_wood_open", 0.8f);
			PlayMusic("08_amb_success", false, 1.0f, 1.5f, 10, false);
		}
		else
		{
			AddTimer("lab", 6.1f, "TimerLoadWood");
			PlayMusic("21_puzzle_door", false, 1.0f, 0.5f, 10, false);
			SetMessage("Jack", "33", 6.0f);
		}
	}
	if(asTimer == "mother")	ChangeMap("02_wood_south_hard.map", "PlayerStartArea_3", "02_woosh", "enemy_hallucination_disappear");
	if(asTimer == "father")	ChangeMap("02_wood_south_hard.map", "PlayerStartArea_4", "02_woosh", "enemy_hallucination_disappear");
	if(asTimer == "storage") ChangeMap("02_wood_south_hard.map", "PlayerStartArea_5", "02_woosh", "enemy_hallucination_disappear");
	if(asTimer == "wine")
	{
		StopPlayerLookAt();
		StartEffectFlash(1.5f, 1.0f, 2.0f);
		ChangeMap("03_wood_north_hard.map", "PlayerStartArea_2", "02_woosh", "enemy_hallucination_disappear");
	}
	if(asTimer == "library")
	{
		StartEffectFlash(1.5f, 1.0f, 2.0f);
		ChangeMap("03_wood_north_hard.map", "PlayerStartArea_5", "02_woosh", "enemy_hallucination_disappear");	
	}
	if(asTimer == "lab")
	{
		StartEffectFlash(1.5f, 1.0f, 2.0f);
		ChangeMap("03_wood_north_hard.map", "PlayerStartArea_4", "02_woosh", "enemy_hallucination_disappear");
	}
	if(asTimer == "laboutside")
	{
		ChangeMap("03_outside_hard.map", "PlayerStartArea_1", "", "door_level_wood_close");
	}
}

void UsedKeyOnDoor(string &in asItem, string &in asEntity)
{
	PlaySoundAtEntity("unlock_door", "unlock_door", asEntity, 0, false);
	if(asEntity == "castle_1")
	{
		SetSwingDoorLocked(asEntity, false, false);
		CompleteQuest("OpenStorageDoor", "OpenStorageDoor");
		AddQuest("StorageMission", "StorageMission");
		GiveSanityBoostSmall();
		SetLocalVarInt("StorageDoorOpened", 1);
		
		CheckPoint ("storagevisionfail", "PlayerStartArea_3", "CPStorageVision", "Hints", "DefaultDeath");
	}
	else if(asEntity == "level_wood_double_1")
	{
		CompleteQuest("LabMission", "LabMission");
		GiveSanityBoostSmall();
		SetEntityActive("grunt_2", false);
		SetEntityActive("brute_1", false);
		SetEntityActive("suitor_1", false);
		SetEntityActive("suitor_2", false);
		SetGlobalVarInt("LabQuestFailed", 1);
		RemoveItem(asItem);
		
		AddTimer("prelab", 0.1f, "TimerLoadWood");
	}
}

void PickedUpNeedle(string &in asEntity)
{
	CheckPoint ("storagevisionfail", "PlayerStartArea_3", "CPStorageVision", "Hints", "DefaultDeath");
	//CompleteQuest("OpenStorageDoor", "OpenStorageDoor");
	SetLocalVarInt("StorageDoorOpened", 1);
	SetEntityActive("AreaEscapeGrunt_1", true);
}

void CPStorageVision(string &in asName, int alCount)
{
	if(GetGlobalVarInt("ItemsAchievement") == 1)
		if(GetPlayerLampOil() <= 20.0f)
			AddPlayerLampOil(20.0f);
	if(GetGlobalVarInt("FastSeekerAchievement") == 1)
		SetPlayerRunSpeedMul(1.175f);
	if(GetGlobalVarInt("WardrobeAchievement") == 1)
		SetPlayerJumpForceMul(1.175f);
	if(GetGlobalVarInt("NoDeathAchievement") == 1)
		SetPlayerHealth(100.1f);
	if(GetGlobalVarInt("SanityAchievement") == 1)
		SetPlayerSanity(100.1f);
	CompleteQuest("OpenStorageDoor", "OpenStorageDoor");
	CompleteQuest("StorageMission", "StorageMission");
	SetGlobalVarInt("StorageQuestFailed", 1);
	SetGlobalVarInt("StorageQuest", 1);
	AddTimer("storage", 1.5f, "TimerLoadWood");
	StartEffectFlash(1.5f, 1.0f, 2.0f);
	
	AddGlobalVarInt("GlobalDeathCount", 1);
}

void CollideAreaWineBarrel(string &in asParent, string &in asChild, int alState)
{
	CompleteQuest("WineMission2", "WineMission2");
	AddQuest("WineMission3", "WineMission3");
	AddTimer("activeplayer", 2.0f, "TimerStopLook");
	SetPlayerActive(false);
	SetMessage("Jack", "17", 8.0f);
	StartPlayerLookAt(asChild, 1.0f, 1.0f, "");
	SetEntityActive("AreaEscapeBrute_2", true);
	SetEntityActive("AreaActiveGrunt_4", true);
	SetSwingDoorClosed("mansion_1", true, false);
	PlaySoundAtEntity("", "oil_tank_empty", asChild, 0.0f, false);
	if(GetGlobalVarInt("FatherQuestFailed") == 1) SetEntityActive("AreaActiveBrute_1", true);
}

void CollideAreaDiscoverStorageDoor(string &in asParent, string &in asChild, int alState)
{
	if(GetLocalVarInt("StorageDoorOpened") == 0)
	{
		AddQuest("OpenStorageDoor", "OpenStorageDoor");
		SetLocalVarInt("StorageDoorOpened", 1);
		SetMessage("Hints", "FindHollowNeedle", 0);
	}
}

void TimerFadeScreen(string &in asTimer)
{
	if(asTimer == "fadein")
	{
		FadeIn(2.0f);
	}
	if(asTimer == "fadeout")
	{
		FadeOut(2.0f);
	}
	if(asTimer == "fadeinactiveplayer")
	{
		FadeIn(2.0f);
		SetPlayerActive(true);
	}
	if(asTimer == "fadeoutactiveplayer")
	{
		FadeOut(2.0f);
		SetPlayerActive(true);	
	}	
}

void TimerStopLook(string &in asTimer)
{
	if(asTimer == "resetspeedmul")
	{
		SetPlayerMoveSpeedMul(1.0f);
		SetPlayerRunSpeedMul(1.0f);
		SetPlayerLookSpeedMul(1.0f);
		if(GetGlobalVarInt("FastSeekerAchievement") == 1)
			SetPlayerRunSpeedMul(1.175f);
		if(GetGlobalVarInt("WardrobeAchievement") == 1)
			SetPlayerJumpForceMul(1.175f);
	}
	if(asTimer == "activeplayer")
	{
		SetPlayerActive(true);
	}
	StopPlayerLookAt();
}

void TimerPlayerReactions(string &in asTimer)
{
	if(asTimer == "scareeffect")
	{
		PlayGuiSound("react_scare", 0.7f);
		GiveSanityDamage(8.0f, false);
		FadeSepiaColorTo(0.5f, 0.025f);
		FadeRadialBlurTo(0.1f, 0.025f);
		SetRadialBlurStartDist(0.2f);
	}
	else if(asTimer == "breatheffect")
	{
		PlayGuiSound("react_breath", 0.4f);
		FadeSepiaColorTo(0, 0.1f);
		FadeRadialBlurTo(0, 0.1f);
	}
	else if(asTimer == "sigheffect")
	{
		PlayGuiSound("react_sigh", 0.4f);
		FadeSepiaColorTo(0, 0.1f);
		FadeRadialBlurTo(0, 0.1f);
	}
	else if(asTimer == "panteffect")
	{
		PlayGuiSound("react_pant", 0.7f);
		GiveSanityDamage(10.0f, false);
		FadeSepiaColorTo(0.5f, 0.025f);
		FadeRadialBlurTo(0.1f, 0.025f);
		SetRadialBlurStartDist(0.2f);
	}
	else if(asTimer == "scare")
	{
		PlayGuiSound("react_scare", 0.7f);
		GiveSanityDamage(8.0f, true);
	}
	else if(asTimer == "breath")
	{
		PlayGuiSound("react_breath", 0.5f);
		GiveSanityDamage(4.0f, false);
	}
	else if(asTimer == "sigh")
	{
		PlayGuiSound("react_sigh", 0.5f);
		GiveSanityDamage(2.0f, false);
	}
	else if(asTimer == "pant")
	{
		PlayGuiSound("react_pant", 0.7f);
		GiveSanityDamage(10.0f, true);
	}
}